module.exports=[30934,t=>{"use strict";var e=t.i(100),a=t.i(52787);let n="https://api.linkedin.com";async function r(t){var r;let s,i,o=t.apiVersion??"202505",c=(r=t.accessToken,{Authorization:`Bearer ${r}`,"LinkedIn-Version":o,"X-Restli-Protocol-Version":"2.0.0",Connection:"Keep-Alive"});if(e.default.info("Fetching LinkedIn Ads campaigns"),!t.accessToken)throw Error("LinkedIn Ads access token is required");let d=`${n}/rest/adAccounts?q=search&search=(status:(values:List(ACTIVE,DRAFT)))`,l=await (0,a.withRateLimit)("linkedin_ads",async()=>{try{let t=await fetch(d,{method:"GET",headers:{...c,"X-RestLi-Method":"finder"}});if(!t.ok){let a=await t.text(),n={};try{n=JSON.parse(a)}catch{n={message:a||t.statusText}}let r=n.message||n.error_description||t.statusText;if(401===t.status||403===t.status)throw new e.PlatformAPIError("linkedin_ads","fetchAdAccounts",Error("Access token expired or invalid. Please reconnect your LinkedIn Ads account."),t.status,n.code?.toString());if(429===t.status){let a=t.headers.get("Retry-After");throw new e.PlatformAPIError("linkedin_ads","fetchAdAccounts",Error(`Rate limit exceeded. Retry after ${a||"some time"}`),t.status,n.code?.toString())}throw new e.PlatformAPIError("linkedin_ads","fetchAdAccounts",Error(r),t.status,n.code?.toString())}return await t.json()}catch(t){if(t instanceof e.PlatformAPIError)throw t;throw new e.PlatformAPIError("linkedin_ads","fetchAdAccounts",t,void 0,void 0)}});if(!l.elements||0===l.elements.length)throw Error("No LinkedIn ad accounts found. Ensure the access token has the required Marketing API permissions.");let u=l.elements[0]?.id;if(!u)throw Error("Invalid LinkedIn ad account ID in response");let h=u.toString().startsWith("urn:li:sponsoredAccount:")?u.toString():`urn:li:sponsoredAccount:${u}`,m=`${n}/rest/adCampaigns?q=search&search=(account:(values:List(${h})))&count=100`,f=await (0,a.withRateLimit)("linkedin_ads",async()=>{try{let t=await fetch(m,{method:"GET",headers:{...c,"X-RestLi-Method":"finder"}});if(!t.ok){let a=await t.text(),n={};try{n=JSON.parse(a)}catch{n={message:a||t.statusText}}let r=n.message||n.error_description||t.statusText;if(401===t.status||403===t.status)throw new e.PlatformAPIError("linkedin_ads","fetchCampaigns",Error("Access token expired or invalid. Please reconnect your LinkedIn Ads account."),t.status,n.code?.toString());if(429===t.status){let a=t.headers.get("Retry-After");throw new e.PlatformAPIError("linkedin_ads","fetchCampaigns",Error(`Rate limit exceeded. Retry after ${a||"some time"}`),t.status,n.code?.toString())}throw new e.PlatformAPIError("linkedin_ads","fetchCampaigns",Error(r),t.status,n.code?.toString())}return await t.json()}catch(t){if(t instanceof e.PlatformAPIError)throw t;throw new e.PlatformAPIError("linkedin_ads","fetchCampaigns",t,void 0,void 0)}});if(!f.elements||0===f.elements.length)return e.default.info("No LinkedIn campaigns found"),[];let g=(s=new Date,(i=new Date).setDate(i.getDate()-30),{start:{year:i.getFullYear(),month:i.getMonth()+1,day:i.getDate()},end:{year:s.getFullYear(),month:s.getMonth()+1,day:s.getDate()}}),p=f.elements.map(t=>t.id),w=new URLSearchParams({q:"analytics",pivot:"CAMPAIGN",dateRange:JSON.stringify(g),campaigns:`List(${p.join(",")})`,fields:"impressions,clicks,costInLocalCurrency,externalWebsiteConversions,conversionValueInLocalCurrency"}),A=`${n}/rest/adAnalytics?${w.toString()}`,y=await (0,a.withRateLimit)("linkedin_ads",async()=>{try{let t=await fetch(A,{method:"GET",headers:{...c,"X-RestLi-Method":"finder"}});if(t.ok)return await t.json();let a=await t.text();return e.default.warn("LinkedIn analytics fetch failed, continuing without analytics",{status:t.status,error:a}),{elements:[]}}catch(t){return e.default.warn("LinkedIn analytics fetch error, continuing without analytics",{error:t}),{elements:[]}}}),k=new Map(y.elements?.map(t=>[t.pivotValues?.[0],t])||[]),I=f.elements.map(t=>({...t,analytics:k.get(t.id)||null}));return(0,e.logAPISuccess)("linkedin_ads","fetchCampaigns",{campaignCount:I.length,withAnalytics:I.filter(t=>t.analytics).length}),I}function s(t){let e=[],a=[];return t.forEach(t=>{var n;e.push({campaign_id:t.id.toString(),campaign_name:t.name,platform:"linkedin_ads",status:{ACTIVE:"active",PAUSED:"paused",ARCHIVED:"archived",DRAFT:"paused"}[n=t.status]||n.toLowerCase(),budget_amount:t.dailyBudget?.amount?parseFloat(t.dailyBudget.amount):null}),t.analytics&&a.push({campaign_api_id:t.id.toString(),date:new Date().toISOString().split("T")[0],impressions:parseInt(t.analytics.impressions)||0,clicks:parseInt(t.analytics.clicks)||0,conversions:parseFloat(t.analytics.externalWebsiteConversions)||0,spend:parseFloat(t.analytics.costInLocalCurrency)||0,revenue:parseFloat(t.analytics.conversionValueInLocalCurrency)||0})}),{campaigns:e,metrics:a}}t.s(["fetchLinkedInAdsCampaigns",()=>r,"transformLinkedInAdsData",()=>s])}];

//# sourceMappingURL=lib_linkedin-ads_client_ts_1e47ed7f._.js.map