{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/lib/rate-limiting/limiter.ts"],"sourcesContent":["/**\r\n * Multi-Platform Rate Limiting using Bottleneck\r\n * Implements platform-specific rate limits and retry strategies\r\n */\r\n\r\nimport Bottleneck from 'bottleneck'\r\nimport logger, { logRateLimit } from '../logging/logger'\r\n\r\n/**\r\n * Rate limit configurations for each platform\r\n * Based on official API documentation\r\n */\r\nconst RATE_LIMIT_CONFIG = {\r\n  google_ads: {\r\n    maxConcurrent: 5,\r\n    minTime: 200, // 5 QPS (queries per second)\r\n    reservoir: 15000, // 15,000 operations per day\r\n    reservoirRefreshAmount: 15000,\r\n    reservoirRefreshInterval: 24 * 60 * 60 * 1000, // 24 hours\r\n  },\r\n  meta_ads: {\r\n    maxConcurrent: 10,\r\n    minTime: 100, // 10 QPS\r\n    // Meta uses dynamic throttling, so we set generous limits\r\n  },\r\n  linkedin_ads: {\r\n    maxConcurrent: 5,\r\n    minTime: 360, // ~3 QPS\r\n    // LinkedIn has application-level daily limits\r\n  },\r\n} as const\r\n\r\ntype Platform = 'google_ads' | 'meta_ads' | 'linkedin_ads'\r\n\r\nclass MultiPlatformRateLimiter {\r\n  private limiters: Record<Platform, Bottleneck>\r\n  private retryStrategies: Record<Platform, (retryCount: number, error: any) => number | null>\r\n\r\n  constructor() {\r\n    this.limiters = {\r\n      google_ads: new Bottleneck(RATE_LIMIT_CONFIG.google_ads),\r\n      meta_ads: new Bottleneck(RATE_LIMIT_CONFIG.meta_ads),\r\n      linkedin_ads: new Bottleneck(RATE_LIMIT_CONFIG.linkedin_ads),\r\n    }\r\n\r\n    this.retryStrategies = {\r\n      google_ads: this.googleAdsRetryStrategy.bind(this),\r\n      meta_ads: this.metaAdsRetryStrategy.bind(this),\r\n      linkedin_ads: this.linkedinAdsRetryStrategy.bind(this),\r\n    }\r\n\r\n    this.setupEventListeners()\r\n  }\r\n\r\n  /**\r\n   * Setup event listeners for all limiters\r\n   */\r\n  private setupEventListeners() {\r\n    Object.entries(this.limiters).forEach(([platform, limiter]) => {\r\n      limiter.on('failed', async (error, jobInfo) => {\r\n        logger.warn(`Rate limiter job failed for ${platform}`, {\r\n          error: error.message,\r\n          jobId: jobInfo.options.id,\r\n          retryCount: jobInfo.retryCount,\r\n        })\r\n\r\n        // Return retry delay based on platform-specific strategy\r\n        const retryDelay = this.retryStrategies[platform as Platform](\r\n          jobInfo.retryCount,\r\n          error\r\n        )\r\n\r\n        if (retryDelay !== null) {\r\n          logger.info(`Retrying ${platform} request in ${retryDelay}ms`)\r\n          return retryDelay\r\n        }\r\n\r\n        // Don't retry\r\n        return null\r\n      })\r\n\r\n      limiter.on('retry', (error, jobInfo) => {\r\n        logger.info(`Retrying ${platform} request`, {\r\n          retryCount: jobInfo.retryCount,\r\n          jobId: jobInfo.options.id,\r\n        })\r\n      })\r\n\r\n      limiter.on('depleted', () => {\r\n        logRateLimit(platform, {\r\n          throttled: true,\r\n          remaining: 0,\r\n        })\r\n        logger.warn(`${platform} rate limiter reservoir depleted`)\r\n      })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Google Ads retry strategy\r\n   * Handles RESOURCE_EXHAUSTED and authentication errors\r\n   */\r\n  private googleAdsRetryStrategy(retryCount: number, error: any): number | null {\r\n    // Max 3 retries\r\n    if (retryCount >= 3) {\r\n      return null\r\n    }\r\n\r\n    // Check if it's a rate limit error\r\n    if (error?.message?.includes('RESOURCE_EXHAUSTED') || error?.message?.includes('RATE_LIMIT_EXCEEDED')) {\r\n      // Exponential backoff: 5s, 10s, 20s\r\n      return Math.pow(2, retryCount) * 5000\r\n    }\r\n\r\n    // Check if it's an authentication error (don't retry)\r\n    if (error?.message?.includes('AUTHENTICATION_ERROR') || error?.message?.includes('PERMISSION_DENIED')) {\r\n      return null\r\n    }\r\n\r\n    // For other errors, short delay\r\n    return 1000\r\n  }\r\n\r\n  /**\r\n   * Meta Ads retry strategy\r\n   * Handles dynamic throttling and token errors\r\n   */\r\n  private metaAdsRetryStrategy(retryCount: number, error: any): number | null {\r\n    // Max 5 retries for Meta (they have more dynamic throttling)\r\n    if (retryCount >= 5) {\r\n      return null\r\n    }\r\n\r\n    const errorCode = error?.response?.data?.error?.code\r\n\r\n    // Rate limit errors (4, 17, 32, 613)\r\n    if ([4, 17, 32, 613].includes(errorCode)) {\r\n      // Exponential backoff: 1s, 2s, 4s, 8s, 16s\r\n      return Math.pow(2, retryCount) * 1000\r\n    }\r\n\r\n    // Token errors (190) - don't retry\r\n    if (errorCode === 190) {\r\n      return null\r\n    }\r\n\r\n    // Other errors - short delay\r\n    return 1000\r\n  }\r\n\r\n  /**\r\n   * LinkedIn Ads retry strategy\r\n   * Handles 429 errors with Retry-After header\r\n   */\r\n  private linkedinAdsRetryStrategy(retryCount: number, error: any): number | null {\r\n    // Max 3 retries\r\n    if (retryCount >= 3) {\r\n      return null\r\n    }\r\n\r\n    const status = error?.response?.status\r\n\r\n    // Rate limit error (429)\r\n    if (status === 429) {\r\n      // Check for Retry-After header\r\n      const retryAfter = error?.response?.headers?.['retry-after']\r\n      if (retryAfter) {\r\n        return parseInt(retryAfter) * 1000\r\n      }\r\n      // Default to 60 seconds if no Retry-After header\r\n      return 60000\r\n    }\r\n\r\n    // Other errors - short delay\r\n    return 1000\r\n  }\r\n\r\n  /**\r\n   * Execute a function with rate limiting\r\n   */\r\n  async executeWithRateLimit<T>(\r\n    platform: Platform,\r\n    fn: () => Promise<T>,\r\n    options?: {\r\n      id?: string\r\n      priority?: number\r\n      weight?: number\r\n    }\r\n  ): Promise<T> {\r\n    const limiter = this.limiters[platform]\r\n\r\n    try {\r\n      const result = await limiter.schedule(\r\n        {\r\n          id: options?.id,\r\n          priority: options?.priority || 5,\r\n          weight: options?.weight || 1,\r\n        },\r\n        fn\r\n      )\r\n\r\n      return result\r\n    } catch (error) {\r\n      logger.error(`Rate limited execution failed for ${platform}`, {\r\n        error,\r\n        options,\r\n      })\r\n      throw error\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current rate limiter status\r\n   */\r\n  getStatus(platform: Platform) {\r\n    const limiter = this.limiters[platform]\r\n\r\n    return {\r\n      running: limiter.running(),\r\n      queued: limiter.queued(),\r\n      done: limiter.done(),\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all platforms status\r\n   */\r\n  getAllStatus() {\r\n    return {\r\n      google_ads: this.getStatus('google_ads'),\r\n      meta_ads: this.getStatus('meta_ads'),\r\n      linkedin_ads: this.getStatus('linkedin_ads'),\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update rate limit configuration dynamically\r\n   */\r\n  updateConfig(platform: Platform, config: Partial<Bottleneck.ConstructorOptions>) {\r\n    const limiter = this.limiters[platform]\r\n    limiter.updateSettings(config)\r\n    logger.info(`Updated rate limit config for ${platform}`, { config })\r\n  }\r\n\r\n  /**\r\n   * Clear queued jobs for a platform\r\n   */\r\n  async clearQueue(platform: Platform) {\r\n    const limiter = this.limiters[platform]\r\n    const cleared = await limiter.stop({ dropWaitingJobs: true })\r\n    logger.info(`Cleared ${platform} rate limiter queue`, { cleared })\r\n    return cleared\r\n  }\r\n\r\n  /**\r\n   * Pause rate limiter for a platform\r\n   */\r\n  async pause(platform: Platform, duration?: number) {\r\n    const limiter = this.limiters[platform]\r\n    await limiter.stop()\r\n\r\n    if (duration) {\r\n      setTimeout(() => {\r\n        logger.info(`Resuming ${platform} rate limiter after ${duration}ms`)\r\n      }, duration)\r\n    }\r\n\r\n    logger.info(`Paused ${platform} rate limiter`, { duration })\r\n  }\r\n\r\n  /**\r\n   * Check Meta API rate limit headers\r\n   */\r\n  checkMetaRateLimit(headers: Record<string, string>) {\r\n    try {\r\n      const appUsage = JSON.parse(headers['x-app-usage'] || '{}')\r\n      const accountUsage = JSON.parse(headers['x-ad-account-usage'] || '{}')\r\n\r\n      const callCount = appUsage.call_count || 0\r\n      const totalTime = appUsage.total_time || 0\r\n\r\n      if (callCount > 80 || totalTime > 80) {\r\n        logRateLimit('meta_ads', {\r\n          remaining: 100 - callCount,\r\n          limit: 100,\r\n          throttled: true,\r\n        })\r\n\r\n        // Auto-throttle if we're getting close to limits\r\n        this.pause('meta_ads', 60000) // Pause for 1 minute\r\n      }\r\n\r\n      return {\r\n        callCount,\r\n        totalTime,\r\n        accountUsage,\r\n      }\r\n    } catch (error) {\r\n      logger.error('Error parsing Meta rate limit headers', { error })\r\n      return null\r\n    }\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nlet rateLimiterInstance: MultiPlatformRateLimiter | null = null\r\n\r\n/**\r\n * Get rate limiter singleton instance\r\n */\r\nexport function getRateLimiter(): MultiPlatformRateLimiter {\r\n  if (!rateLimiterInstance) {\r\n    rateLimiterInstance = new MultiPlatformRateLimiter()\r\n  }\r\n  return rateLimiterInstance\r\n}\r\n\r\n/**\r\n * Convenience function to execute with rate limiting\r\n */\r\nexport async function withRateLimit<T>(\r\n  platform: Platform,\r\n  fn: () => Promise<T>,\r\n  options?: {\r\n    id?: string\r\n    priority?: number\r\n    weight?: number\r\n  }\r\n): Promise<T> {\r\n  const limiter = getRateLimiter()\r\n  return limiter.executeWithRateLimit(platform, fn, options)\r\n}\r\n\r\nexport default getRateLimiter\r\n\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAED;AACA;;;AAEA;;;CAGC,GACD,MAAM,oBAAoB;IACxB,YAAY;QACV,eAAe;QACf,SAAS;QACT,WAAW;QACX,wBAAwB;QACxB,0BAA0B,KAAK,KAAK,KAAK;IAC3C;IACA,UAAU;QACR,eAAe;QACf,SAAS;IAEX;IACA,cAAc;QACZ,eAAe;QACf,SAAS;IAEX;AACF;AAIA,MAAM;IACI,SAAsC;IACtC,gBAAoF;IAE5F,aAAc;QACZ,IAAI,CAAC,QAAQ,GAAG;YACd,YAAY,IAAI,uJAAU,CAAC,kBAAkB,UAAU;YACvD,UAAU,IAAI,uJAAU,CAAC,kBAAkB,QAAQ;YACnD,cAAc,IAAI,uJAAU,CAAC,kBAAkB,YAAY;QAC7D;QAEA,IAAI,CAAC,eAAe,GAAG;YACrB,YAAY,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI;YACjD,UAAU,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI;YAC7C,cAAc,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI;QACvD;QAEA,IAAI,CAAC,mBAAmB;IAC1B;IAEA;;GAEC,GACD,AAAQ,sBAAsB;QAC5B,OAAO,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,UAAU,QAAQ;YACxD,QAAQ,EAAE,CAAC,UAAU,OAAO,OAAO;gBACjC,qIAAM,CAAC,IAAI,CAAC,CAAC,4BAA4B,EAAE,UAAU,EAAE;oBACrD,OAAO,MAAM,OAAO;oBACpB,OAAO,QAAQ,OAAO,CAAC,EAAE;oBACzB,YAAY,QAAQ,UAAU;gBAChC;gBAEA,yDAAyD;gBACzD,MAAM,aAAa,IAAI,CAAC,eAAe,CAAC,SAAqB,CAC3D,QAAQ,UAAU,EAClB;gBAGF,IAAI,eAAe,MAAM;oBACvB,qIAAM,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,SAAS,YAAY,EAAE,WAAW,EAAE,CAAC;oBAC7D,OAAO;gBACT;gBAEA,cAAc;gBACd,OAAO;YACT;YAEA,QAAQ,EAAE,CAAC,SAAS,CAAC,OAAO;gBAC1B,qIAAM,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,SAAS,QAAQ,CAAC,EAAE;oBAC1C,YAAY,QAAQ,UAAU;oBAC9B,OAAO,QAAQ,OAAO,CAAC,EAAE;gBAC3B;YACF;YAEA,QAAQ,EAAE,CAAC,YAAY;gBACrB,IAAA,0IAAY,EAAC,UAAU;oBACrB,WAAW;oBACX,WAAW;gBACb;gBACA,qIAAM,CAAC,IAAI,CAAC,GAAG,SAAS,gCAAgC,CAAC;YAC3D;QACF;IACF;IAEA;;;GAGC,GACD,AAAQ,uBAAuB,UAAkB,EAAE,KAAU,EAAiB;QAC5E,gBAAgB;QAChB,IAAI,cAAc,GAAG;YACnB,OAAO;QACT;QAEA,mCAAmC;QACnC,IAAI,OAAO,SAAS,SAAS,yBAAyB,OAAO,SAAS,SAAS,wBAAwB;YACrG,oCAAoC;YACpC,OAAO,KAAK,GAAG,CAAC,GAAG,cAAc;QACnC;QAEA,sDAAsD;QACtD,IAAI,OAAO,SAAS,SAAS,2BAA2B,OAAO,SAAS,SAAS,sBAAsB;YACrG,OAAO;QACT;QAEA,gCAAgC;QAChC,OAAO;IACT;IAEA;;;GAGC,GACD,AAAQ,qBAAqB,UAAkB,EAAE,KAAU,EAAiB;QAC1E,6DAA6D;QAC7D,IAAI,cAAc,GAAG;YACnB,OAAO;QACT;QAEA,MAAM,YAAY,OAAO,UAAU,MAAM,OAAO;QAEhD,qCAAqC;QACrC,IAAI;YAAC;YAAG;YAAI;YAAI;SAAI,CAAC,QAAQ,CAAC,YAAY;YACxC,2CAA2C;YAC3C,OAAO,KAAK,GAAG,CAAC,GAAG,cAAc;QACnC;QAEA,mCAAmC;QACnC,IAAI,cAAc,KAAK;YACrB,OAAO;QACT;QAEA,6BAA6B;QAC7B,OAAO;IACT;IAEA;;;GAGC,GACD,AAAQ,yBAAyB,UAAkB,EAAE,KAAU,EAAiB;QAC9E,gBAAgB;QAChB,IAAI,cAAc,GAAG;YACnB,OAAO;QACT;QAEA,MAAM,SAAS,OAAO,UAAU;QAEhC,yBAAyB;QACzB,IAAI,WAAW,KAAK;YAClB,+BAA+B;YAC/B,MAAM,aAAa,OAAO,UAAU,SAAS,CAAC,cAAc;YAC5D,IAAI,YAAY;gBACd,OAAO,SAAS,cAAc;YAChC;YACA,iDAAiD;YACjD,OAAO;QACT;QAEA,6BAA6B;QAC7B,OAAO;IACT;IAEA;;GAEC,GACD,MAAM,qBACJ,QAAkB,EAClB,EAAoB,EACpB,OAIC,EACW;QACZ,MAAM,UAAU,IAAI,CAAC,QAAQ,CAAC,SAAS;QAEvC,IAAI;YACF,MAAM,SAAS,MAAM,QAAQ,QAAQ,CACnC;gBACE,IAAI,SAAS;gBACb,UAAU,SAAS,YAAY;gBAC/B,QAAQ,SAAS,UAAU;YAC7B,GACA;YAGF,OAAO;QACT,EAAE,OAAO,OAAO;YACd,qIAAM,CAAC,KAAK,CAAC,CAAC,kCAAkC,EAAE,UAAU,EAAE;gBAC5D;gBACA;YACF;YACA,MAAM;QACR;IACF;IAEA;;GAEC,GACD,UAAU,QAAkB,EAAE;QAC5B,MAAM,UAAU,IAAI,CAAC,QAAQ,CAAC,SAAS;QAEvC,OAAO;YACL,SAAS,QAAQ,OAAO;YACxB,QAAQ,QAAQ,MAAM;YACtB,MAAM,QAAQ,IAAI;QACpB;IACF;IAEA;;GAEC,GACD,eAAe;QACb,OAAO;YACL,YAAY,IAAI,CAAC,SAAS,CAAC;YAC3B,UAAU,IAAI,CAAC,SAAS,CAAC;YACzB,cAAc,IAAI,CAAC,SAAS,CAAC;QAC/B;IACF;IAEA;;GAEC,GACD,aAAa,QAAkB,EAAE,MAA8C,EAAE;QAC/E,MAAM,UAAU,IAAI,CAAC,QAAQ,CAAC,SAAS;QACvC,QAAQ,cAAc,CAAC;QACvB,qIAAM,CAAC,IAAI,CAAC,CAAC,8BAA8B,EAAE,UAAU,EAAE;YAAE;QAAO;IACpE;IAEA;;GAEC,GACD,MAAM,WAAW,QAAkB,EAAE;QACnC,MAAM,UAAU,IAAI,CAAC,QAAQ,CAAC,SAAS;QACvC,MAAM,UAAU,MAAM,QAAQ,IAAI,CAAC;YAAE,iBAAiB;QAAK;QAC3D,qIAAM,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,SAAS,mBAAmB,CAAC,EAAE;YAAE;QAAQ;QAChE,OAAO;IACT;IAEA;;GAEC,GACD,MAAM,MAAM,QAAkB,EAAE,QAAiB,EAAE;QACjD,MAAM,UAAU,IAAI,CAAC,QAAQ,CAAC,SAAS;QACvC,MAAM,QAAQ,IAAI;QAElB,IAAI,UAAU;YACZ,WAAW;gBACT,qIAAM,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,SAAS,oBAAoB,EAAE,SAAS,EAAE,CAAC;YACrE,GAAG;QACL;QAEA,qIAAM,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,SAAS,aAAa,CAAC,EAAE;YAAE;QAAS;IAC5D;IAEA;;GAEC,GACD,mBAAmB,OAA+B,EAAE;QAClD,IAAI;YACF,MAAM,WAAW,KAAK,KAAK,CAAC,OAAO,CAAC,cAAc,IAAI;YACtD,MAAM,eAAe,KAAK,KAAK,CAAC,OAAO,CAAC,qBAAqB,IAAI;YAEjE,MAAM,YAAY,SAAS,UAAU,IAAI;YACzC,MAAM,YAAY,SAAS,UAAU,IAAI;YAEzC,IAAI,YAAY,MAAM,YAAY,IAAI;gBACpC,IAAA,0IAAY,EAAC,YAAY;oBACvB,WAAW,MAAM;oBACjB,OAAO;oBACP,WAAW;gBACb;gBAEA,iDAAiD;gBACjD,IAAI,CAAC,KAAK,CAAC,YAAY,QAAO,qBAAqB;YACrD;YAEA,OAAO;gBACL;gBACA;gBACA;YACF;QACF,EAAE,OAAO,OAAO;YACd,qIAAM,CAAC,KAAK,CAAC,yCAAyC;gBAAE;YAAM;YAC9D,OAAO;QACT;IACF;AACF;AAEA,qBAAqB;AACrB,IAAI,sBAAuD;AAKpD,SAAS;IACd,IAAI,CAAC,qBAAqB;QACxB,sBAAsB,IAAI;IAC5B;IACA,OAAO;AACT;AAKO,eAAe,cACpB,QAAkB,EAClB,EAAoB,EACpB,OAIC;IAED,MAAM,UAAU;IAChB,OAAO,QAAQ,oBAAoB,CAAC,UAAU,IAAI;AACpD;uCAEe"}},
    {"offset": {"line": 277, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/lib/linkedin-ads/client.ts"],"sourcesContent":["/**\r\n * LinkedIn Ads API Client\r\n * Documentation:\r\n * - Authentication: https://learn.microsoft.com/en-us/linkedin/shared/authentication/authentication\r\n * - Getting Access: https://learn.microsoft.com/en-us/linkedin/shared/authentication/getting-access\r\n * - Marketing API: https://learn.microsoft.com/en-us/linkedin/marketing/\r\n * - Best Practices: https://learn.microsoft.com/en-us/linkedin/shared/api-guide/best-practices/overview\r\n * \r\n * Note: Marketing API requires approval as an Advertising API partner.\r\n * Uses Rest.li Protocol 2.0.0 with LinkedIn-specific headers.\r\n */\r\n\r\nimport logger, { PlatformAPIError, logAPISuccess } from '../logging/logger'\r\nimport { withRateLimit } from '../rate-limiting/limiter'\r\n\r\nconst DEFAULT_API_VERSION = '202505'\r\nconst LINKEDIN_API_BASE = 'https://api.linkedin.com'\r\n\r\nexport interface LinkedInAdsConfig {\r\n  accessToken: string\r\n  apiVersion?: string\r\n}\r\n\r\n/**\r\n * Helper to create standard LinkedIn API headers following Rest.li protocol\r\n */\r\nfunction getLinkedInHeaders(accessToken: string, apiVersion: string): Record<string, string> {\r\n  return {\r\n    'Authorization': `Bearer ${accessToken}`,\r\n    'LinkedIn-Version': apiVersion,\r\n    'X-Restli-Protocol-Version': '2.0.0',\r\n    'Connection': 'Keep-Alive',\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate date range for last 30 days in LinkedIn format\r\n */\r\nfunction getDateRange() {\r\n  const end = new Date()\r\n  const start = new Date()\r\n  start.setDate(start.getDate() - 30)\r\n\r\n  return {\r\n    start: {\r\n      year: start.getFullYear(),\r\n      month: start.getMonth() + 1,\r\n      day: start.getDate(),\r\n    },\r\n    end: {\r\n      year: end.getFullYear(),\r\n      month: end.getMonth() + 1,\r\n      day: end.getDate(),\r\n    },\r\n  }\r\n}\r\n\r\nexport async function fetchLinkedInAdsCampaigns(config: LinkedInAdsConfig) {\r\n  const apiVersion = config.apiVersion ?? DEFAULT_API_VERSION\r\n  const headers = getLinkedInHeaders(config.accessToken, apiVersion)\r\n\r\n  logger.info('Fetching LinkedIn Ads campaigns')\r\n\r\n  // Validate required configuration\r\n  if (!config.accessToken) {\r\n    throw new Error('LinkedIn Ads access token is required')\r\n  }\r\n\r\n  // Step 1: Fetch ad accounts using Rest.li finder method\r\n  const accountsUrl = `${LINKEDIN_API_BASE}/rest/adAccounts?q=search&search=(status:(values:List(ACTIVE,DRAFT)))`\r\n  \r\n  const accountsData = await withRateLimit('linkedin_ads', async () => {\r\n    try {\r\n      const accountsResponse = await fetch(accountsUrl, {\r\n        method: 'GET',\r\n        headers: {\r\n          ...headers,\r\n          'X-RestLi-Method': 'finder',\r\n        },\r\n      })\r\n\r\n      if (!accountsResponse.ok) {\r\n        const errorText = await accountsResponse.text()\r\n        let error: any = {}\r\n        try {\r\n          error = JSON.parse(errorText)\r\n        } catch {\r\n          error = { message: errorText || accountsResponse.statusText }\r\n        }\r\n\r\n        // Handle specific LinkedIn API errors\r\n        const errorMessage = error.message || error.error_description || accountsResponse.statusText\r\n\r\n        // Token expiration or invalid token\r\n        if (accountsResponse.status === 401 || accountsResponse.status === 403) {\r\n          throw new PlatformAPIError(\r\n            'linkedin_ads',\r\n            'fetchAdAccounts',\r\n            new Error('Access token expired or invalid. Please reconnect your LinkedIn Ads account.'),\r\n            accountsResponse.status,\r\n            error.code?.toString()\r\n          )\r\n        }\r\n\r\n        // Rate limit errors\r\n        if (accountsResponse.status === 429) {\r\n          const retryAfter = accountsResponse.headers.get('Retry-After')\r\n          throw new PlatformAPIError(\r\n            'linkedin_ads',\r\n            'fetchAdAccounts',\r\n            new Error(`Rate limit exceeded. Retry after ${retryAfter || 'some time'}`),\r\n            accountsResponse.status,\r\n            error.code?.toString()\r\n          )\r\n        }\r\n\r\n        throw new PlatformAPIError(\r\n          'linkedin_ads',\r\n          'fetchAdAccounts',\r\n          new Error(errorMessage),\r\n          accountsResponse.status,\r\n          error.code?.toString()\r\n        )\r\n      }\r\n\r\n      return await accountsResponse.json()\r\n    } catch (error: any) {\r\n      // Re-throw PlatformAPIError as-is\r\n      if (error instanceof PlatformAPIError) {\r\n        throw error\r\n      }\r\n      // Wrap other errors\r\n      throw new PlatformAPIError(\r\n        'linkedin_ads',\r\n        'fetchAdAccounts',\r\n        error,\r\n        undefined,\r\n        undefined\r\n      )\r\n    }\r\n  })\r\n  \r\n  if (!accountsData.elements || accountsData.elements.length === 0) {\r\n    throw new Error('No LinkedIn ad accounts found. Ensure the access token has the required Marketing API permissions.')\r\n  }\r\n\r\n  const adAccountId = accountsData.elements[0]?.id\r\n  if (!adAccountId) {\r\n    throw new Error('Invalid LinkedIn ad account ID in response')\r\n  }\r\n\r\n  // Step 2: Fetch campaigns for the ad account\r\n  // Build URN properly - account ID should be numeric\r\n  const accountUrn = adAccountId.toString().startsWith('urn:li:sponsoredAccount:') \r\n    ? adAccountId.toString() \r\n    : `urn:li:sponsoredAccount:${adAccountId}`\r\n  \r\n  const campaignsUrl = `${LINKEDIN_API_BASE}/rest/adCampaigns?q=search&search=(account:(values:List(${accountUrn})))&count=100`\r\n  \r\n  const campaignsData = await withRateLimit('linkedin_ads', async () => {\r\n    try {\r\n      const campaignsResponse = await fetch(campaignsUrl, {\r\n        method: 'GET',\r\n        headers: {\r\n          ...headers,\r\n          'X-RestLi-Method': 'finder',\r\n        },\r\n      })\r\n\r\n      if (!campaignsResponse.ok) {\r\n        const errorText = await campaignsResponse.text()\r\n        let error: any = {}\r\n        try {\r\n          error = JSON.parse(errorText)\r\n        } catch {\r\n          error = { message: errorText || campaignsResponse.statusText }\r\n        }\r\n\r\n        const errorMessage = error.message || error.error_description || campaignsResponse.statusText\r\n\r\n        // Token expiration or invalid token\r\n        if (campaignsResponse.status === 401 || campaignsResponse.status === 403) {\r\n          throw new PlatformAPIError(\r\n            'linkedin_ads',\r\n            'fetchCampaigns',\r\n            new Error('Access token expired or invalid. Please reconnect your LinkedIn Ads account.'),\r\n            campaignsResponse.status,\r\n            error.code?.toString()\r\n          )\r\n        }\r\n\r\n        // Rate limit errors\r\n        if (campaignsResponse.status === 429) {\r\n          const retryAfter = campaignsResponse.headers.get('Retry-After')\r\n          throw new PlatformAPIError(\r\n            'linkedin_ads',\r\n            'fetchCampaigns',\r\n            new Error(`Rate limit exceeded. Retry after ${retryAfter || 'some time'}`),\r\n            campaignsResponse.status,\r\n            error.code?.toString()\r\n          )\r\n        }\r\n\r\n        throw new PlatformAPIError(\r\n          'linkedin_ads',\r\n          'fetchCampaigns',\r\n          new Error(errorMessage),\r\n          campaignsResponse.status,\r\n          error.code?.toString()\r\n        )\r\n      }\r\n\r\n      return await campaignsResponse.json()\r\n    } catch (error: any) {\r\n      // Re-throw PlatformAPIError as-is\r\n      if (error instanceof PlatformAPIError) {\r\n        throw error\r\n      }\r\n      // Wrap other errors\r\n      throw new PlatformAPIError(\r\n        'linkedin_ads',\r\n        'fetchCampaigns',\r\n        error,\r\n        undefined,\r\n        undefined\r\n      )\r\n    }\r\n  })\r\n\r\n  if (!campaignsData.elements || campaignsData.elements.length === 0) {\r\n    logger.info('No LinkedIn campaigns found')\r\n    return []\r\n  }\r\n\r\n  // Step 3: Fetch analytics for campaigns (batch request for efficiency)\r\n  const dateRange = getDateRange()\r\n  const campaignIds = campaignsData.elements.map((c: any) => c.id)\r\n\r\n  const analyticsParams = new URLSearchParams({\r\n    q: 'analytics',\r\n    pivot: 'CAMPAIGN',\r\n    dateRange: JSON.stringify(dateRange),\r\n    campaigns: `List(${campaignIds.join(',')})`,\r\n    fields: 'impressions,clicks,costInLocalCurrency,externalWebsiteConversions,conversionValueInLocalCurrency',\r\n  })\r\n\r\n  const analyticsUrl = `${LINKEDIN_API_BASE}/rest/adAnalytics?${analyticsParams.toString()}`\r\n  \r\n  const analyticsData = await withRateLimit('linkedin_ads', async () => {\r\n    try {\r\n      const analyticsResponse = await fetch(analyticsUrl, {\r\n        method: 'GET',\r\n        headers: {\r\n          ...headers,\r\n          'X-RestLi-Method': 'finder',\r\n        },\r\n      })\r\n\r\n      if (analyticsResponse.ok) {\r\n        return await analyticsResponse.json()\r\n      }\r\n      \r\n      // Log warning but don't fail the entire request if analytics fails\r\n      const errorText = await analyticsResponse.text()\r\n      logger.warn('LinkedIn analytics fetch failed, continuing without analytics', {\r\n        status: analyticsResponse.status,\r\n        error: errorText,\r\n      })\r\n      return { elements: [] }\r\n    } catch (error: any) {\r\n      // Don't fail the entire request if analytics fails\r\n      logger.warn('LinkedIn analytics fetch error, continuing without analytics', { error })\r\n      return { elements: [] }\r\n    }\r\n  })\r\n\r\n  // Map analytics to campaigns\r\n  const analyticsMap = new Map(\r\n    analyticsData.elements?.map((a: any) => [a.pivotValues?.[0], a]) || []\r\n  )\r\n\r\n  const campaignsWithMetrics = campaignsData.elements.map((campaign: any) => ({\r\n    ...campaign,\r\n    analytics: analyticsMap.get(campaign.id) || null,\r\n  }))\r\n\r\n  logAPISuccess('linkedin_ads', 'fetchCampaigns', {\r\n    campaignCount: campaignsWithMetrics.length,\r\n    withAnalytics: campaignsWithMetrics.filter((c: any) => c.analytics).length,\r\n  })\r\n\r\n  return campaignsWithMetrics\r\n}\r\n\r\nexport function transformLinkedInAdsData(apiData: any[]) {\r\n  const campaigns: any[] = []\r\n  const metrics: any[] = []\r\n\r\n  apiData.forEach((campaign: any) => {\r\n    campaigns.push({\r\n      campaign_id: campaign.id.toString(),\r\n      campaign_name: campaign.name,\r\n      platform: 'linkedin_ads',\r\n      status: normalizeLinkedInStatus(campaign.status),\r\n      budget_amount: campaign.dailyBudget?.amount\r\n        ? parseFloat(campaign.dailyBudget.amount)\r\n        : null,\r\n    })\r\n\r\n    if (campaign.analytics) {\r\n      metrics.push({\r\n        campaign_api_id: campaign.id.toString(),\r\n        date: new Date().toISOString().split('T')[0],\r\n        impressions: parseInt(campaign.analytics.impressions) || 0,\r\n        clicks: parseInt(campaign.analytics.clicks) || 0,\r\n        conversions: parseFloat(campaign.analytics.externalWebsiteConversions) || 0,\r\n        spend: parseFloat(campaign.analytics.costInLocalCurrency) || 0,\r\n        revenue: parseFloat(campaign.analytics.conversionValueInLocalCurrency) || 0,\r\n      })\r\n    }\r\n  })\r\n\r\n  return { campaigns, metrics }\r\n}\r\n\r\nfunction normalizeLinkedInStatus(status: string): string {\r\n  const statusMap: Record<string, string> = {\r\n    'ACTIVE': 'active',\r\n    'PAUSED': 'paused',\r\n    'ARCHIVED': 'archived',\r\n    'DRAFT': 'paused',\r\n  }\r\n  return statusMap[status] || status.toLowerCase()\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 534, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/parser.js"],"sourcesContent":["\"use strict\";\n\nexports.load = function (received, defaults, onto = {}) {\n  var k, ref, v;\n\n  for (k in defaults) {\n    v = defaults[k];\n    onto[k] = (ref = received[k]) != null ? ref : v;\n  }\n\n  return onto;\n};\n\nexports.overwrite = function (received, defaults, onto = {}) {\n  var k, v;\n\n  for (k in received) {\n    v = received[k];\n\n    if (defaults[k] !== void 0) {\n      onto[k] = v;\n    }\n  }\n\n  return onto;\n};"],"names":[],"mappings":"AAEA,QAAQ,IAAI,GAAG,SAAU,QAAQ,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IACpD,IAAI,GAAG,KAAK;IAEZ,IAAK,KAAK,SAAU;QAClB,IAAI,QAAQ,CAAC,EAAE;QACf,IAAI,CAAC,EAAE,GAAG,CAAC,MAAM,QAAQ,CAAC,EAAE,KAAK,OAAO,MAAM;IAChD;IAEA,OAAO;AACT;AAEA,QAAQ,SAAS,GAAG,SAAU,QAAQ,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IACzD,IAAI,GAAG;IAEP,IAAK,KAAK,SAAU;QAClB,IAAI,QAAQ,CAAC,EAAE;QAEf,IAAI,QAAQ,CAAC,EAAE,KAAK,KAAK,GAAG;YAC1B,IAAI,CAAC,EAAE,GAAG;QACZ;IACF;IAEA,OAAO;AACT","ignoreList":[0]}},
    {"offset": {"line": 556, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/DLList.js"],"sourcesContent":["\"use strict\";\n\nvar DLList;\nDLList = class DLList {\n  constructor(incr, decr) {\n    this.incr = incr;\n    this.decr = decr;\n    this._first = null;\n    this._last = null;\n    this.length = 0;\n  }\n\n  push(value) {\n    var node;\n    this.length++;\n\n    if (typeof this.incr === \"function\") {\n      this.incr();\n    }\n\n    node = {\n      value,\n      prev: this._last,\n      next: null\n    };\n\n    if (this._last != null) {\n      this._last.next = node;\n      this._last = node;\n    } else {\n      this._first = this._last = node;\n    }\n\n    return void 0;\n  }\n\n  shift() {\n    var value;\n\n    if (this._first == null) {\n      return;\n    } else {\n      this.length--;\n\n      if (typeof this.decr === \"function\") {\n        this.decr();\n      }\n    }\n\n    value = this._first.value;\n\n    if ((this._first = this._first.next) != null) {\n      this._first.prev = null;\n    } else {\n      this._last = null;\n    }\n\n    return value;\n  }\n\n  first() {\n    if (this._first != null) {\n      return this._first.value;\n    }\n  }\n\n  getArray() {\n    var node, ref, results;\n    node = this._first;\n    results = [];\n\n    while (node != null) {\n      results.push((ref = node, node = node.next, ref.value));\n    }\n\n    return results;\n  }\n\n  forEachShift(cb) {\n    var node;\n    node = this.shift();\n\n    while (node != null) {\n      cb(node), node = this.shift();\n    }\n\n    return void 0;\n  }\n\n  debug() {\n    var node, ref, ref1, ref2, results;\n    node = this._first;\n    results = [];\n\n    while (node != null) {\n      results.push((ref = node, node = node.next, {\n        value: ref.value,\n        prev: (ref1 = ref.prev) != null ? ref1.value : void 0,\n        next: (ref2 = ref.next) != null ? ref2.value : void 0\n      }));\n    }\n\n    return results;\n  }\n\n};\nmodule.exports = DLList;"],"names":[],"mappings":"AAEA,IAAI;AACJ,SAAS,MAAM;IACb,YAAY,IAAI,EAAE,IAAI,CAAE;QACtB,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,MAAM,GAAG;IAChB;IAEA,KAAK,KAAK,EAAE;QACV,IAAI;QACJ,IAAI,CAAC,MAAM;QAEX,IAAI,OAAO,IAAI,CAAC,IAAI,KAAK,YAAY;YACnC,IAAI,CAAC,IAAI;QACX;QAEA,OAAO;YACL;YACA,MAAM,IAAI,CAAC,KAAK;YAChB,MAAM;QACR;QAEA,IAAI,IAAI,CAAC,KAAK,IAAI,MAAM;YACtB,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG;YAClB,IAAI,CAAC,KAAK,GAAG;QACf,OAAO;YACL,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,GAAG;QAC7B;QAEA,OAAO,KAAK;IACd;IAEA,QAAQ;QACN,IAAI;QAEJ,IAAI,IAAI,CAAC,MAAM,IAAI,MAAM;YACvB;QACF,OAAO;YACL,IAAI,CAAC,MAAM;YAEX,IAAI,OAAO,IAAI,CAAC,IAAI,KAAK,YAAY;gBACnC,IAAI,CAAC,IAAI;YACX;QACF;QAEA,QAAQ,IAAI,CAAC,MAAM,CAAC,KAAK;QAEzB,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,KAAK,MAAM;YAC5C,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG;QACrB,OAAO;YACL,IAAI,CAAC,KAAK,GAAG;QACf;QAEA,OAAO;IACT;IAEA,QAAQ;QACN,IAAI,IAAI,CAAC,MAAM,IAAI,MAAM;YACvB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK;QAC1B;IACF;IAEA,WAAW;QACT,IAAI,MAAM,KAAK;QACf,OAAO,IAAI,CAAC,MAAM;QAClB,UAAU,EAAE;QAEZ,MAAO,QAAQ,KAAM;YACnB,QAAQ,IAAI,CAAC,CAAC,MAAM,MAAM,OAAO,KAAK,IAAI,EAAE,IAAI,KAAK;QACvD;QAEA,OAAO;IACT;IAEA,aAAa,EAAE,EAAE;QACf,IAAI;QACJ,OAAO,IAAI,CAAC,KAAK;QAEjB,MAAO,QAAQ,KAAM;YACnB,GAAG,OAAO,OAAO,IAAI,CAAC,KAAK;QAC7B;QAEA,OAAO,KAAK;IACd;IAEA,QAAQ;QACN,IAAI,MAAM,KAAK,MAAM,MAAM;QAC3B,OAAO,IAAI,CAAC,MAAM;QAClB,UAAU,EAAE;QAEZ,MAAO,QAAQ,KAAM;YACnB,QAAQ,IAAI,CAAC,CAAC,MAAM,MAAM,OAAO,KAAK,IAAI,EAAE;gBAC1C,OAAO,IAAI,KAAK;gBAChB,MAAM,CAAC,OAAO,IAAI,IAAI,KAAK,OAAO,KAAK,KAAK,GAAG,KAAK;gBACpD,MAAM,CAAC,OAAO,IAAI,IAAI,KAAK,OAAO,KAAK,KAAK,GAAG,KAAK;YACtD,CAAC;QACH;QAEA,OAAO;IACT;AAEF;AACA,OAAO,OAAO,GAAG","ignoreList":[0]}},
    {"offset": {"line": 643, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/Events.js"],"sourcesContent":["\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Events;\nEvents = class Events {\n  constructor(instance) {\n    this.instance = instance;\n    this._events = {};\n\n    if (this.instance.on != null || this.instance.once != null || this.instance.removeAllListeners != null) {\n      throw new Error(\"An Emitter already exists for this object\");\n    }\n\n    this.instance.on = (name, cb) => {\n      return this._addListener(name, \"many\", cb);\n    };\n\n    this.instance.once = (name, cb) => {\n      return this._addListener(name, \"once\", cb);\n    };\n\n    this.instance.removeAllListeners = (name = null) => {\n      if (name != null) {\n        return delete this._events[name];\n      } else {\n        return this._events = {};\n      }\n    };\n  }\n\n  _addListener(name, status, cb) {\n    var base;\n\n    if ((base = this._events)[name] == null) {\n      base[name] = [];\n    }\n\n    this._events[name].push({\n      cb,\n      status\n    });\n\n    return this.instance;\n  }\n\n  listenerCount(name) {\n    if (this._events[name] != null) {\n      return this._events[name].length;\n    } else {\n      return 0;\n    }\n  }\n\n  trigger(name, ...args) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var e, promises;\n\n      try {\n        if (name !== \"debug\") {\n          _this.trigger(\"debug\", `Event triggered: ${name}`, args);\n        }\n\n        if (_this._events[name] == null) {\n          return;\n        }\n\n        _this._events[name] = _this._events[name].filter(function (listener) {\n          return listener.status !== \"none\";\n        });\n        promises = _this._events[name].map(\n        /*#__PURE__*/\n        function () {\n          var _ref = _asyncToGenerator(function* (listener) {\n            var e, returned;\n\n            if (listener.status === \"none\") {\n              return;\n            }\n\n            if (listener.status === \"once\") {\n              listener.status = \"none\";\n            }\n\n            try {\n              returned = typeof listener.cb === \"function\" ? listener.cb(...args) : void 0;\n\n              if (typeof (returned != null ? returned.then : void 0) === \"function\") {\n                return yield returned;\n              } else {\n                return returned;\n              }\n            } catch (error) {\n              e = error;\n\n              if (\"name\" !== \"error\") {\n                _this.trigger(\"error\", e);\n              }\n\n              return null;\n            }\n          });\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n        return (yield Promise.all(promises)).find(function (x) {\n          return x != null;\n        });\n      } catch (error) {\n        e = error;\n\n        if (\"name\" !== \"error\") {\n          _this.trigger(\"error\", e);\n        }\n\n        return null;\n      }\n    })();\n  }\n\n};\nmodule.exports = Events;"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 772, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/Queues.js"],"sourcesContent":["\"use strict\";\n\nvar DLList, Events, Queues;\nDLList = require(\"./DLList\");\nEvents = require(\"./Events\");\nQueues = class Queues {\n  constructor(num_priorities) {\n    var i;\n    this.Events = new Events(this);\n    this._length = 0;\n\n    this._lists = function () {\n      var j, ref, results;\n      results = [];\n\n      for (i = j = 1, ref = num_priorities; 1 <= ref ? j <= ref : j >= ref; i = 1 <= ref ? ++j : --j) {\n        results.push(new DLList(() => {\n          return this.incr();\n        }, () => {\n          return this.decr();\n        }));\n      }\n\n      return results;\n    }.call(this);\n  }\n\n  incr() {\n    if (this._length++ === 0) {\n      return this.Events.trigger(\"leftzero\");\n    }\n  }\n\n  decr() {\n    if (--this._length === 0) {\n      return this.Events.trigger(\"zero\");\n    }\n  }\n\n  push(job) {\n    return this._lists[job.options.priority].push(job);\n  }\n\n  queued(priority) {\n    if (priority != null) {\n      return this._lists[priority].length;\n    } else {\n      return this._length;\n    }\n  }\n\n  shiftAll(fn) {\n    return this._lists.forEach(function (list) {\n      return list.forEachShift(fn);\n    });\n  }\n\n  getFirst(arr = this._lists) {\n    var j, len, list;\n\n    for (j = 0, len = arr.length; j < len; j++) {\n      list = arr[j];\n\n      if (list.length > 0) {\n        return list;\n      }\n    }\n\n    return [];\n  }\n\n  shiftLastFrom(priority) {\n    return this.getFirst(this._lists.slice(priority).reverse()).shift();\n  }\n\n};\nmodule.exports = Queues;"],"names":[],"mappings":"AAEA,IAAI,QAAQ,QAAQ;AACpB;AACA;AACA,SAAS,MAAM;IACb,YAAY,cAAc,CAAE;QAC1B,IAAI;QACJ,IAAI,CAAC,MAAM,GAAG,IAAI,OAAO,IAAI;QAC7B,IAAI,CAAC,OAAO,GAAG;QAEf,IAAI,CAAC,MAAM,GAAG,CAAA;YACZ,IAAI,GAAG,KAAK;YACZ,UAAU,EAAE;YAEZ,IAAK,IAAI,IAAI,GAAG,MAAM,gBAAgB,KAAK,MAAM,KAAK,MAAM,KAAK,KAAK,IAAI,KAAK,MAAM,EAAE,IAAI,EAAE,EAAG;gBAC9F,QAAQ,IAAI,CAAC,IAAI,OAAO;oBACtB,OAAO,IAAI,CAAC,IAAI;gBAClB,GAAG;oBACD,OAAO,IAAI,CAAC,IAAI;gBAClB;YACF;YAEA,OAAO;QACT,CAAA,EAAE,IAAI,CAAC,IAAI;IACb;IAEA,OAAO;QACL,IAAI,IAAI,CAAC,OAAO,OAAO,GAAG;YACxB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;QAC7B;IACF;IAEA,OAAO;QACL,IAAI,EAAE,IAAI,CAAC,OAAO,KAAK,GAAG;YACxB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;QAC7B;IACF;IAEA,KAAK,GAAG,EAAE;QACR,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC;IAChD;IAEA,OAAO,QAAQ,EAAE;QACf,IAAI,YAAY,MAAM;YACpB,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM;QACrC,OAAO;YACL,OAAO,IAAI,CAAC,OAAO;QACrB;IACF;IAEA,SAAS,EAAE,EAAE;QACX,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAU,IAAI;YACvC,OAAO,KAAK,YAAY,CAAC;QAC3B;IACF;IAEA,SAAS,MAAM,IAAI,CAAC,MAAM,EAAE;QAC1B,IAAI,GAAG,KAAK;QAEZ,IAAK,IAAI,GAAG,MAAM,IAAI,MAAM,EAAE,IAAI,KAAK,IAAK;YAC1C,OAAO,GAAG,CAAC,EAAE;YAEb,IAAI,KAAK,MAAM,GAAG,GAAG;gBACnB,OAAO;YACT;QACF;QAEA,OAAO,EAAE;IACX;IAEA,cAAc,QAAQ,EAAE;QACtB,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,OAAO,IAAI,KAAK;IACnE;AAEF;AACA,OAAO,OAAO,GAAG","ignoreList":[0]}},
    {"offset": {"line": 837, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/BottleneckError.js"],"sourcesContent":["\"use strict\";\n\nvar BottleneckError;\nBottleneckError = class BottleneckError extends Error {};\nmodule.exports = BottleneckError;"],"names":[],"mappings":"AAEA,IAAI;AACJ,kBAAkB,MAAM,wBAAwB;AAAO;AACvD,OAAO,OAAO,GAAG","ignoreList":[0]}},
    {"offset": {"line": 845, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/Job.js"],"sourcesContent":["\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar BottleneckError, DEFAULT_PRIORITY, Job, NUM_PRIORITIES, parser;\nNUM_PRIORITIES = 10;\nDEFAULT_PRIORITY = 5;\nparser = require(\"./parser\");\nBottleneckError = require(\"./BottleneckError\");\nJob = class Job {\n  constructor(task, args, options, jobDefaults, rejectOnDrop, Events, _states, Promise) {\n    this.task = task;\n    this.args = args;\n    this.rejectOnDrop = rejectOnDrop;\n    this.Events = Events;\n    this._states = _states;\n    this.Promise = Promise;\n    this.options = parser.load(options, jobDefaults);\n    this.options.priority = this._sanitizePriority(this.options.priority);\n\n    if (this.options.id === jobDefaults.id) {\n      this.options.id = `${this.options.id}-${this._randomIndex()}`;\n    }\n\n    this.promise = new this.Promise((_resolve, _reject) => {\n      this._resolve = _resolve;\n      this._reject = _reject;\n    });\n    this.retryCount = 0;\n  }\n\n  _sanitizePriority(priority) {\n    var sProperty;\n    sProperty = ~~priority !== priority ? DEFAULT_PRIORITY : priority;\n\n    if (sProperty < 0) {\n      return 0;\n    } else if (sProperty > NUM_PRIORITIES - 1) {\n      return NUM_PRIORITIES - 1;\n    } else {\n      return sProperty;\n    }\n  }\n\n  _randomIndex() {\n    return Math.random().toString(36).slice(2);\n  }\n\n  doDrop({\n    error,\n    message = \"This job has been dropped by Bottleneck\"\n  } = {}) {\n    if (this._states.remove(this.options.id)) {\n      if (this.rejectOnDrop) {\n        this._reject(error != null ? error : new BottleneckError(message));\n      }\n\n      this.Events.trigger(\"dropped\", {\n        args: this.args,\n        options: this.options,\n        task: this.task,\n        promise: this.promise\n      });\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  _assertStatus(expected) {\n    var status;\n    status = this._states.jobStatus(this.options.id);\n\n    if (!(status === expected || expected === \"DONE\" && status === null)) {\n      throw new BottleneckError(`Invalid job status ${status}, expected ${expected}. Please open an issue at https://github.com/SGrondin/bottleneck/issues`);\n    }\n  }\n\n  doReceive() {\n    this._states.start(this.options.id);\n\n    return this.Events.trigger(\"received\", {\n      args: this.args,\n      options: this.options\n    });\n  }\n\n  doQueue(reachedHWM, blocked) {\n    this._assertStatus(\"RECEIVED\");\n\n    this._states.next(this.options.id);\n\n    return this.Events.trigger(\"queued\", {\n      args: this.args,\n      options: this.options,\n      reachedHWM,\n      blocked\n    });\n  }\n\n  doRun() {\n    if (this.retryCount === 0) {\n      this._assertStatus(\"QUEUED\");\n\n      this._states.next(this.options.id);\n    } else {\n      this._assertStatus(\"EXECUTING\");\n    }\n\n    return this.Events.trigger(\"scheduled\", {\n      args: this.args,\n      options: this.options\n    });\n  }\n\n  doExecute(chained, clearGlobalState, run, free) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var error, eventInfo, passed;\n\n      if (_this.retryCount === 0) {\n        _this._assertStatus(\"RUNNING\");\n\n        _this._states.next(_this.options.id);\n      } else {\n        _this._assertStatus(\"EXECUTING\");\n      }\n\n      eventInfo = {\n        args: _this.args,\n        options: _this.options,\n        retryCount: _this.retryCount\n      };\n\n      _this.Events.trigger(\"executing\", eventInfo);\n\n      try {\n        passed = yield chained != null ? chained.schedule(_this.options, _this.task, ..._this.args) : _this.task(..._this.args);\n\n        if (clearGlobalState()) {\n          _this.doDone(eventInfo);\n\n          yield free(_this.options, eventInfo);\n\n          _this._assertStatus(\"DONE\");\n\n          return _this._resolve(passed);\n        }\n      } catch (error1) {\n        error = error1;\n        return _this._onFailure(error, eventInfo, clearGlobalState, run, free);\n      }\n    })();\n  }\n\n  doExpire(clearGlobalState, run, free) {\n    var error, eventInfo;\n\n    if (this._states.jobStatus(this.options.id === \"RUNNING\")) {\n      this._states.next(this.options.id);\n    }\n\n    this._assertStatus(\"EXECUTING\");\n\n    eventInfo = {\n      args: this.args,\n      options: this.options,\n      retryCount: this.retryCount\n    };\n    error = new BottleneckError(`This job timed out after ${this.options.expiration} ms.`);\n    return this._onFailure(error, eventInfo, clearGlobalState, run, free);\n  }\n\n  _onFailure(error, eventInfo, clearGlobalState, run, free) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var retry, retryAfter;\n\n      if (clearGlobalState()) {\n        retry = yield _this2.Events.trigger(\"failed\", error, eventInfo);\n\n        if (retry != null) {\n          retryAfter = ~~retry;\n\n          _this2.Events.trigger(\"retry\", `Retrying ${_this2.options.id} after ${retryAfter} ms`, eventInfo);\n\n          _this2.retryCount++;\n          return run(retryAfter);\n        } else {\n          _this2.doDone(eventInfo);\n\n          yield free(_this2.options, eventInfo);\n\n          _this2._assertStatus(\"DONE\");\n\n          return _this2._reject(error);\n        }\n      }\n    })();\n  }\n\n  doDone(eventInfo) {\n    this._assertStatus(\"EXECUTING\");\n\n    this._states.next(this.options.id);\n\n    return this.Events.trigger(\"done\", eventInfo);\n  }\n\n};\nmodule.exports = Job;"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1039, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/LocalDatastore.js"],"sourcesContent":["\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar BottleneckError, LocalDatastore, parser;\nparser = require(\"./parser\");\nBottleneckError = require(\"./BottleneckError\");\nLocalDatastore = class LocalDatastore {\n  constructor(instance, storeOptions, storeInstanceOptions) {\n    this.instance = instance;\n    this.storeOptions = storeOptions;\n    this.clientId = this.instance._randomIndex();\n    parser.load(storeInstanceOptions, storeInstanceOptions, this);\n    this._nextRequest = this._lastReservoirRefresh = this._lastReservoirIncrease = Date.now();\n    this._running = 0;\n    this._done = 0;\n    this._unblockTime = 0;\n    this.ready = this.Promise.resolve();\n    this.clients = {};\n\n    this._startHeartbeat();\n  }\n\n  _startHeartbeat() {\n    var base;\n\n    if (this.heartbeat == null && (this.storeOptions.reservoirRefreshInterval != null && this.storeOptions.reservoirRefreshAmount != null || this.storeOptions.reservoirIncreaseInterval != null && this.storeOptions.reservoirIncreaseAmount != null)) {\n      return typeof (base = this.heartbeat = setInterval(() => {\n        var amount, incr, maximum, now, reservoir;\n        now = Date.now();\n\n        if (this.storeOptions.reservoirRefreshInterval != null && now >= this._lastReservoirRefresh + this.storeOptions.reservoirRefreshInterval) {\n          this._lastReservoirRefresh = now;\n          this.storeOptions.reservoir = this.storeOptions.reservoirRefreshAmount;\n\n          this.instance._drainAll(this.computeCapacity());\n        }\n\n        if (this.storeOptions.reservoirIncreaseInterval != null && now >= this._lastReservoirIncrease + this.storeOptions.reservoirIncreaseInterval) {\n          var _this$storeOptions = this.storeOptions;\n          amount = _this$storeOptions.reservoirIncreaseAmount;\n          maximum = _this$storeOptions.reservoirIncreaseMaximum;\n          reservoir = _this$storeOptions.reservoir;\n          this._lastReservoirIncrease = now;\n          incr = maximum != null ? Math.min(amount, maximum - reservoir) : amount;\n\n          if (incr > 0) {\n            this.storeOptions.reservoir += incr;\n            return this.instance._drainAll(this.computeCapacity());\n          }\n        }\n      }, this.heartbeatInterval)).unref === \"function\" ? base.unref() : void 0;\n    } else {\n      return clearInterval(this.heartbeat);\n    }\n  }\n\n  __publish__(message) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.yieldLoop();\n      return _this.instance.Events.trigger(\"message\", message.toString());\n    })();\n  }\n\n  __disconnect__(flush) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this2.yieldLoop();\n      clearInterval(_this2.heartbeat);\n      return _this2.Promise.resolve();\n    })();\n  }\n\n  yieldLoop(t = 0) {\n    return new this.Promise(function (resolve, reject) {\n      return setTimeout(resolve, t);\n    });\n  }\n\n  computePenalty() {\n    var ref;\n    return (ref = this.storeOptions.penalty) != null ? ref : 15 * this.storeOptions.minTime || 5000;\n  }\n\n  __updateSettings__(options) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this3.yieldLoop();\n      parser.overwrite(options, options, _this3.storeOptions);\n\n      _this3._startHeartbeat();\n\n      _this3.instance._drainAll(_this3.computeCapacity());\n\n      return true;\n    })();\n  }\n\n  __running__() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this4.yieldLoop();\n      return _this4._running;\n    })();\n  }\n\n  __queued__() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this5.yieldLoop();\n      return _this5.instance.queued();\n    })();\n  }\n\n  __done__() {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this6.yieldLoop();\n      return _this6._done;\n    })();\n  }\n\n  __groupCheck__(time) {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this7.yieldLoop();\n      return _this7._nextRequest + _this7.timeout < time;\n    })();\n  }\n\n  computeCapacity() {\n    var maxConcurrent, reservoir;\n    var _this$storeOptions2 = this.storeOptions;\n    maxConcurrent = _this$storeOptions2.maxConcurrent;\n    reservoir = _this$storeOptions2.reservoir;\n\n    if (maxConcurrent != null && reservoir != null) {\n      return Math.min(maxConcurrent - this._running, reservoir);\n    } else if (maxConcurrent != null) {\n      return maxConcurrent - this._running;\n    } else if (reservoir != null) {\n      return reservoir;\n    } else {\n      return null;\n    }\n  }\n\n  conditionsCheck(weight) {\n    var capacity;\n    capacity = this.computeCapacity();\n    return capacity == null || weight <= capacity;\n  }\n\n  __incrementReservoir__(incr) {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      var reservoir;\n      yield _this8.yieldLoop();\n      reservoir = _this8.storeOptions.reservoir += incr;\n\n      _this8.instance._drainAll(_this8.computeCapacity());\n\n      return reservoir;\n    })();\n  }\n\n  __currentReservoir__() {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this9.yieldLoop();\n      return _this9.storeOptions.reservoir;\n    })();\n  }\n\n  isBlocked(now) {\n    return this._unblockTime >= now;\n  }\n\n  check(weight, now) {\n    return this.conditionsCheck(weight) && this._nextRequest - now <= 0;\n  }\n\n  __check__(weight) {\n    var _this10 = this;\n\n    return _asyncToGenerator(function* () {\n      var now;\n      yield _this10.yieldLoop();\n      now = Date.now();\n      return _this10.check(weight, now);\n    })();\n  }\n\n  __register__(index, weight, expiration) {\n    var _this11 = this;\n\n    return _asyncToGenerator(function* () {\n      var now, wait;\n      yield _this11.yieldLoop();\n      now = Date.now();\n\n      if (_this11.conditionsCheck(weight)) {\n        _this11._running += weight;\n\n        if (_this11.storeOptions.reservoir != null) {\n          _this11.storeOptions.reservoir -= weight;\n        }\n\n        wait = Math.max(_this11._nextRequest - now, 0);\n        _this11._nextRequest = now + wait + _this11.storeOptions.minTime;\n        return {\n          success: true,\n          wait,\n          reservoir: _this11.storeOptions.reservoir\n        };\n      } else {\n        return {\n          success: false\n        };\n      }\n    })();\n  }\n\n  strategyIsBlock() {\n    return this.storeOptions.strategy === 3;\n  }\n\n  __submit__(queueLength, weight) {\n    var _this12 = this;\n\n    return _asyncToGenerator(function* () {\n      var blocked, now, reachedHWM;\n      yield _this12.yieldLoop();\n\n      if (_this12.storeOptions.maxConcurrent != null && weight > _this12.storeOptions.maxConcurrent) {\n        throw new BottleneckError(`Impossible to add a job having a weight of ${weight} to a limiter having a maxConcurrent setting of ${_this12.storeOptions.maxConcurrent}`);\n      }\n\n      now = Date.now();\n      reachedHWM = _this12.storeOptions.highWater != null && queueLength === _this12.storeOptions.highWater && !_this12.check(weight, now);\n      blocked = _this12.strategyIsBlock() && (reachedHWM || _this12.isBlocked(now));\n\n      if (blocked) {\n        _this12._unblockTime = now + _this12.computePenalty();\n        _this12._nextRequest = _this12._unblockTime + _this12.storeOptions.minTime;\n\n        _this12.instance._dropAllQueued();\n      }\n\n      return {\n        reachedHWM,\n        blocked,\n        strategy: _this12.storeOptions.strategy\n      };\n    })();\n  }\n\n  __free__(index, weight) {\n    var _this13 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this13.yieldLoop();\n      _this13._running -= weight;\n      _this13._done += weight;\n\n      _this13.instance._drainAll(_this13.computeCapacity());\n\n      return {\n        running: _this13._running\n      };\n    })();\n  }\n\n};\nmodule.exports = LocalDatastore;"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1295, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/bottleneck/lib/lua.json"],"sourcesContent":["{\"blacklist_client.lua\":\"local blacklist = ARGV[num_static_argv + 1]\\n\\nif redis.call('zscore', client_last_seen_key, blacklist) then\\n  redis.call('zadd', client_last_seen_key, 0, blacklist)\\nend\\n\\n\\nreturn {}\\n\",\"check.lua\":\"local weight = tonumber(ARGV[num_static_argv + 1])\\n\\nlocal capacity = process_tick(now, false)['capacity']\\nlocal nextRequest = tonumber(redis.call('hget', settings_key, 'nextRequest'))\\n\\nreturn conditions_check(capacity, weight) and nextRequest - now <= 0\\n\",\"conditions_check.lua\":\"local conditions_check = function (capacity, weight)\\n  return capacity == nil or weight <= capacity\\nend\\n\",\"current_reservoir.lua\":\"return process_tick(now, false)['reservoir']\\n\",\"done.lua\":\"process_tick(now, false)\\n\\nreturn tonumber(redis.call('hget', settings_key, 'done'))\\n\",\"free.lua\":\"local index = ARGV[num_static_argv + 1]\\n\\nredis.call('zadd', job_expirations_key, 0, index)\\n\\nreturn process_tick(now, false)['running']\\n\",\"get_time.lua\":\"redis.replicate_commands()\\n\\nlocal get_time = function ()\\n  local time = redis.call('time')\\n\\n  return tonumber(time[1]..string.sub(time[2], 1, 3))\\nend\\n\",\"group_check.lua\":\"return not (redis.call('exists', settings_key) == 1)\\n\",\"heartbeat.lua\":\"process_tick(now, true)\\n\",\"increment_reservoir.lua\":\"local incr = tonumber(ARGV[num_static_argv + 1])\\n\\nredis.call('hincrby', settings_key, 'reservoir', incr)\\n\\nlocal reservoir = process_tick(now, true)['reservoir']\\n\\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\\nrefresh_expiration(0, 0, groupTimeout)\\n\\nreturn reservoir\\n\",\"init.lua\":\"local clear = tonumber(ARGV[num_static_argv + 1])\\nlocal limiter_version = ARGV[num_static_argv + 2]\\nlocal num_local_argv = num_static_argv + 2\\n\\nif clear == 1 then\\n  redis.call('del', unpack(KEYS))\\nend\\n\\nif redis.call('exists', settings_key) == 0 then\\n  -- Create\\n  local args = {'hmset', settings_key}\\n\\n  for i = num_local_argv + 1, #ARGV do\\n    table.insert(args, ARGV[i])\\n  end\\n\\n  redis.call(unpack(args))\\n  redis.call('hmset', settings_key,\\n    'nextRequest', now,\\n    'lastReservoirRefresh', now,\\n    'lastReservoirIncrease', now,\\n    'running', 0,\\n    'done', 0,\\n    'unblockTime', 0,\\n    'capacityPriorityCounter', 0\\n  )\\n\\nelse\\n  -- Apply migrations\\n  local settings = redis.call('hmget', settings_key,\\n    'id',\\n    'version'\\n  )\\n  local id = settings[1]\\n  local current_version = settings[2]\\n\\n  if current_version ~= limiter_version then\\n    local version_digits = {}\\n    for k, v in string.gmatch(current_version, \\\"([^.]+)\\\") do\\n      table.insert(version_digits, tonumber(k))\\n    end\\n\\n    -- 2.10.0\\n    if version_digits[2] < 10 then\\n      redis.call('hsetnx', settings_key, 'reservoirRefreshInterval', '')\\n      redis.call('hsetnx', settings_key, 'reservoirRefreshAmount', '')\\n      redis.call('hsetnx', settings_key, 'lastReservoirRefresh', '')\\n      redis.call('hsetnx', settings_key, 'done', 0)\\n      redis.call('hset', settings_key, 'version', '2.10.0')\\n    end\\n\\n    -- 2.11.1\\n    if version_digits[2] < 11 or (version_digits[2] == 11 and version_digits[3] < 1) then\\n      if redis.call('hstrlen', settings_key, 'lastReservoirRefresh') == 0 then\\n        redis.call('hmset', settings_key,\\n          'lastReservoirRefresh', now,\\n          'version', '2.11.1'\\n        )\\n      end\\n    end\\n\\n    -- 2.14.0\\n    if version_digits[2] < 14 then\\n      local old_running_key = 'b_'..id..'_running'\\n      local old_executing_key = 'b_'..id..'_executing'\\n\\n      if redis.call('exists', old_running_key) == 1 then\\n        redis.call('rename', old_running_key, job_weights_key)\\n      end\\n      if redis.call('exists', old_executing_key) == 1 then\\n        redis.call('rename', old_executing_key, job_expirations_key)\\n      end\\n      redis.call('hset', settings_key, 'version', '2.14.0')\\n    end\\n\\n    -- 2.15.2\\n    if version_digits[2] < 15 or (version_digits[2] == 15 and version_digits[3] < 2) then\\n      redis.call('hsetnx', settings_key, 'capacityPriorityCounter', 0)\\n      redis.call('hset', settings_key, 'version', '2.15.2')\\n    end\\n\\n    -- 2.17.0\\n    if version_digits[2] < 17 then\\n      redis.call('hsetnx', settings_key, 'clientTimeout', 10000)\\n      redis.call('hset', settings_key, 'version', '2.17.0')\\n    end\\n\\n    -- 2.18.0\\n    if version_digits[2] < 18 then\\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseInterval', '')\\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseAmount', '')\\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseMaximum', '')\\n      redis.call('hsetnx', settings_key, 'lastReservoirIncrease', now)\\n      redis.call('hset', settings_key, 'version', '2.18.0')\\n    end\\n\\n  end\\n\\n  process_tick(now, false)\\nend\\n\\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\\nrefresh_expiration(0, 0, groupTimeout)\\n\\nreturn {}\\n\",\"process_tick.lua\":\"local process_tick = function (now, always_publish)\\n\\n  local compute_capacity = function (maxConcurrent, running, reservoir)\\n    if maxConcurrent ~= nil and reservoir ~= nil then\\n      return math.min((maxConcurrent - running), reservoir)\\n    elseif maxConcurrent ~= nil then\\n      return maxConcurrent - running\\n    elseif reservoir ~= nil then\\n      return reservoir\\n    else\\n      return nil\\n    end\\n  end\\n\\n  local settings = redis.call('hmget', settings_key,\\n    'id',\\n    'maxConcurrent',\\n    'running',\\n    'reservoir',\\n    'reservoirRefreshInterval',\\n    'reservoirRefreshAmount',\\n    'lastReservoirRefresh',\\n    'reservoirIncreaseInterval',\\n    'reservoirIncreaseAmount',\\n    'reservoirIncreaseMaximum',\\n    'lastReservoirIncrease',\\n    'capacityPriorityCounter',\\n    'clientTimeout'\\n  )\\n  local id = settings[1]\\n  local maxConcurrent = tonumber(settings[2])\\n  local running = tonumber(settings[3])\\n  local reservoir = tonumber(settings[4])\\n  local reservoirRefreshInterval = tonumber(settings[5])\\n  local reservoirRefreshAmount = tonumber(settings[6])\\n  local lastReservoirRefresh = tonumber(settings[7])\\n  local reservoirIncreaseInterval = tonumber(settings[8])\\n  local reservoirIncreaseAmount = tonumber(settings[9])\\n  local reservoirIncreaseMaximum = tonumber(settings[10])\\n  local lastReservoirIncrease = tonumber(settings[11])\\n  local capacityPriorityCounter = tonumber(settings[12])\\n  local clientTimeout = tonumber(settings[13])\\n\\n  local initial_capacity = compute_capacity(maxConcurrent, running, reservoir)\\n\\n  --\\n  -- Process 'running' changes\\n  --\\n  local expired = redis.call('zrangebyscore', job_expirations_key, '-inf', '('..now)\\n\\n  if #expired > 0 then\\n    redis.call('zremrangebyscore', job_expirations_key, '-inf', '('..now)\\n\\n    local flush_batch = function (batch, acc)\\n      local weights = redis.call('hmget', job_weights_key, unpack(batch))\\n                      redis.call('hdel',  job_weights_key, unpack(batch))\\n      local clients = redis.call('hmget', job_clients_key, unpack(batch))\\n                      redis.call('hdel',  job_clients_key, unpack(batch))\\n\\n      -- Calculate sum of removed weights\\n      for i = 1, #weights do\\n        acc['total'] = acc['total'] + (tonumber(weights[i]) or 0)\\n      end\\n\\n      -- Calculate sum of removed weights by client\\n      local client_weights = {}\\n      for i = 1, #clients do\\n        local removed = tonumber(weights[i]) or 0\\n        if removed > 0 then\\n          acc['client_weights'][clients[i]] = (acc['client_weights'][clients[i]] or 0) + removed\\n        end\\n      end\\n    end\\n\\n    local acc = {\\n      ['total'] = 0,\\n      ['client_weights'] = {}\\n    }\\n    local batch_size = 1000\\n\\n    -- Compute changes to Zsets and apply changes to Hashes\\n    for i = 1, #expired, batch_size do\\n      local batch = {}\\n      for j = i, math.min(i + batch_size - 1, #expired) do\\n        table.insert(batch, expired[j])\\n      end\\n\\n      flush_batch(batch, acc)\\n    end\\n\\n    -- Apply changes to Zsets\\n    if acc['total'] > 0 then\\n      redis.call('hincrby', settings_key, 'done', acc['total'])\\n      running = tonumber(redis.call('hincrby', settings_key, 'running', -acc['total']))\\n    end\\n\\n    for client, weight in pairs(acc['client_weights']) do\\n      redis.call('zincrby', client_running_key, -weight, client)\\n    end\\n  end\\n\\n  --\\n  -- Process 'reservoir' changes\\n  --\\n  local reservoirRefreshActive = reservoirRefreshInterval ~= nil and reservoirRefreshAmount ~= nil\\n  if reservoirRefreshActive and now >= lastReservoirRefresh + reservoirRefreshInterval then\\n    reservoir = reservoirRefreshAmount\\n    redis.call('hmset', settings_key,\\n      'reservoir', reservoir,\\n      'lastReservoirRefresh', now\\n    )\\n  end\\n\\n  local reservoirIncreaseActive = reservoirIncreaseInterval ~= nil and reservoirIncreaseAmount ~= nil\\n  if reservoirIncreaseActive and now >= lastReservoirIncrease + reservoirIncreaseInterval then\\n    local num_intervals = math.floor((now - lastReservoirIncrease) / reservoirIncreaseInterval)\\n    local incr = reservoirIncreaseAmount * num_intervals\\n    if reservoirIncreaseMaximum ~= nil then\\n      incr = math.min(incr, reservoirIncreaseMaximum - (reservoir or 0))\\n    end\\n    if incr > 0 then\\n      reservoir = (reservoir or 0) + incr\\n    end\\n    redis.call('hmset', settings_key,\\n      'reservoir', reservoir,\\n      'lastReservoirIncrease', lastReservoirIncrease + (num_intervals * reservoirIncreaseInterval)\\n    )\\n  end\\n\\n  --\\n  -- Clear unresponsive clients\\n  --\\n  local unresponsive = redis.call('zrangebyscore', client_last_seen_key, '-inf', (now - clientTimeout))\\n  local unresponsive_lookup = {}\\n  local terminated_clients = {}\\n  for i = 1, #unresponsive do\\n    unresponsive_lookup[unresponsive[i]] = true\\n    if tonumber(redis.call('zscore', client_running_key, unresponsive[i])) == 0 then\\n      table.insert(terminated_clients, unresponsive[i])\\n    end\\n  end\\n  if #terminated_clients > 0 then\\n    redis.call('zrem', client_running_key,         unpack(terminated_clients))\\n    redis.call('hdel', client_num_queued_key,      unpack(terminated_clients))\\n    redis.call('zrem', client_last_registered_key, unpack(terminated_clients))\\n    redis.call('zrem', client_last_seen_key,       unpack(terminated_clients))\\n  end\\n\\n  --\\n  -- Broadcast capacity changes\\n  --\\n  local final_capacity = compute_capacity(maxConcurrent, running, reservoir)\\n\\n  if always_publish or (initial_capacity ~= nil and final_capacity == nil) then\\n    -- always_publish or was not unlimited, now unlimited\\n    redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))\\n\\n  elseif initial_capacity ~= nil and final_capacity ~= nil and final_capacity > initial_capacity then\\n    -- capacity was increased\\n    -- send the capacity message to the limiter having the lowest number of running jobs\\n    -- the tiebreaker is the limiter having not registered a job in the longest time\\n\\n    local lowest_concurrency_value = nil\\n    local lowest_concurrency_clients = {}\\n    local lowest_concurrency_last_registered = {}\\n    local client_concurrencies = redis.call('zrange', client_running_key, 0, -1, 'withscores')\\n\\n    for i = 1, #client_concurrencies, 2 do\\n      local client = client_concurrencies[i]\\n      local concurrency = tonumber(client_concurrencies[i+1])\\n\\n      if (\\n        lowest_concurrency_value == nil or lowest_concurrency_value == concurrency\\n      ) and (\\n        not unresponsive_lookup[client]\\n      ) and (\\n        tonumber(redis.call('hget', client_num_queued_key, client)) > 0\\n      ) then\\n        lowest_concurrency_value = concurrency\\n        table.insert(lowest_concurrency_clients, client)\\n        local last_registered = tonumber(redis.call('zscore', client_last_registered_key, client))\\n        table.insert(lowest_concurrency_last_registered, last_registered)\\n      end\\n    end\\n\\n    if #lowest_concurrency_clients > 0 then\\n      local position = 1\\n      local earliest = lowest_concurrency_last_registered[1]\\n\\n      for i,v in ipairs(lowest_concurrency_last_registered) do\\n        if v < earliest then\\n          position = i\\n          earliest = v\\n        end\\n      end\\n\\n      local next_client = lowest_concurrency_clients[position]\\n      redis.call('publish', 'b_'..id,\\n        'capacity-priority:'..(final_capacity or '')..\\n        ':'..next_client..\\n        ':'..capacityPriorityCounter\\n      )\\n      redis.call('hincrby', settings_key, 'capacityPriorityCounter', '1')\\n    else\\n      redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))\\n    end\\n  end\\n\\n  return {\\n    ['capacity'] = final_capacity,\\n    ['running'] = running,\\n    ['reservoir'] = reservoir\\n  }\\nend\\n\",\"queued.lua\":\"local clientTimeout = tonumber(redis.call('hget', settings_key, 'clientTimeout'))\\nlocal valid_clients = redis.call('zrangebyscore', client_last_seen_key, (now - clientTimeout), 'inf')\\nlocal client_queued = redis.call('hmget', client_num_queued_key, unpack(valid_clients))\\n\\nlocal sum = 0\\nfor i = 1, #client_queued do\\n  sum = sum + tonumber(client_queued[i])\\nend\\n\\nreturn sum\\n\",\"refresh_expiration.lua\":\"local refresh_expiration = function (now, nextRequest, groupTimeout)\\n\\n  if groupTimeout ~= nil then\\n    local ttl = (nextRequest + groupTimeout) - now\\n\\n    for i = 1, #KEYS do\\n      redis.call('pexpire', KEYS[i], ttl)\\n    end\\n  end\\n\\nend\\n\",\"refs.lua\":\"local settings_key = KEYS[1]\\nlocal job_weights_key = KEYS[2]\\nlocal job_expirations_key = KEYS[3]\\nlocal job_clients_key = KEYS[4]\\nlocal client_running_key = KEYS[5]\\nlocal client_num_queued_key = KEYS[6]\\nlocal client_last_registered_key = KEYS[7]\\nlocal client_last_seen_key = KEYS[8]\\n\\nlocal now = tonumber(ARGV[1])\\nlocal client = ARGV[2]\\n\\nlocal num_static_argv = 2\\n\",\"register.lua\":\"local index = ARGV[num_static_argv + 1]\\nlocal weight = tonumber(ARGV[num_static_argv + 2])\\nlocal expiration = tonumber(ARGV[num_static_argv + 3])\\n\\nlocal state = process_tick(now, false)\\nlocal capacity = state['capacity']\\nlocal reservoir = state['reservoir']\\n\\nlocal settings = redis.call('hmget', settings_key,\\n  'nextRequest',\\n  'minTime',\\n  'groupTimeout'\\n)\\nlocal nextRequest = tonumber(settings[1])\\nlocal minTime = tonumber(settings[2])\\nlocal groupTimeout = tonumber(settings[3])\\n\\nif conditions_check(capacity, weight) then\\n\\n  redis.call('hincrby', settings_key, 'running', weight)\\n  redis.call('hset', job_weights_key, index, weight)\\n  if expiration ~= nil then\\n    redis.call('zadd', job_expirations_key, now + expiration, index)\\n  end\\n  redis.call('hset', job_clients_key, index, client)\\n  redis.call('zincrby', client_running_key, weight, client)\\n  redis.call('hincrby', client_num_queued_key, client, -1)\\n  redis.call('zadd', client_last_registered_key, now, client)\\n\\n  local wait = math.max(nextRequest - now, 0)\\n  local newNextRequest = now + wait + minTime\\n\\n  if reservoir == nil then\\n    redis.call('hset', settings_key,\\n      'nextRequest', newNextRequest\\n    )\\n  else\\n    reservoir = reservoir - weight\\n    redis.call('hmset', settings_key,\\n      'reservoir', reservoir,\\n      'nextRequest', newNextRequest\\n    )\\n  end\\n\\n  refresh_expiration(now, newNextRequest, groupTimeout)\\n\\n  return {true, wait, reservoir}\\n\\nelse\\n  return {false}\\nend\\n\",\"register_client.lua\":\"local queued = tonumber(ARGV[num_static_argv + 1])\\n\\n-- Could have been re-registered concurrently\\nif not redis.call('zscore', client_last_seen_key, client) then\\n  redis.call('zadd', client_running_key, 0, client)\\n  redis.call('hset', client_num_queued_key, client, queued)\\n  redis.call('zadd', client_last_registered_key, 0, client)\\nend\\n\\nredis.call('zadd', client_last_seen_key, now, client)\\n\\nreturn {}\\n\",\"running.lua\":\"return process_tick(now, false)['running']\\n\",\"submit.lua\":\"local queueLength = tonumber(ARGV[num_static_argv + 1])\\nlocal weight = tonumber(ARGV[num_static_argv + 2])\\n\\nlocal capacity = process_tick(now, false)['capacity']\\n\\nlocal settings = redis.call('hmget', settings_key,\\n  'id',\\n  'maxConcurrent',\\n  'highWater',\\n  'nextRequest',\\n  'strategy',\\n  'unblockTime',\\n  'penalty',\\n  'minTime',\\n  'groupTimeout'\\n)\\nlocal id = settings[1]\\nlocal maxConcurrent = tonumber(settings[2])\\nlocal highWater = tonumber(settings[3])\\nlocal nextRequest = tonumber(settings[4])\\nlocal strategy = tonumber(settings[5])\\nlocal unblockTime = tonumber(settings[6])\\nlocal penalty = tonumber(settings[7])\\nlocal minTime = tonumber(settings[8])\\nlocal groupTimeout = tonumber(settings[9])\\n\\nif maxConcurrent ~= nil and weight > maxConcurrent then\\n  return redis.error_reply('OVERWEIGHT:'..weight..':'..maxConcurrent)\\nend\\n\\nlocal reachedHWM = (highWater ~= nil and queueLength == highWater\\n  and not (\\n    conditions_check(capacity, weight)\\n    and nextRequest - now <= 0\\n  )\\n)\\n\\nlocal blocked = strategy == 3 and (reachedHWM or unblockTime >= now)\\n\\nif blocked then\\n  local computedPenalty = penalty\\n  if computedPenalty == nil then\\n    if minTime == 0 then\\n      computedPenalty = 5000\\n    else\\n      computedPenalty = 15 * minTime\\n    end\\n  end\\n\\n  local newNextRequest = now + computedPenalty + minTime\\n\\n  redis.call('hmset', settings_key,\\n    'unblockTime', now + computedPenalty,\\n    'nextRequest', newNextRequest\\n  )\\n\\n  local clients_queued_reset = redis.call('hkeys', client_num_queued_key)\\n  local queued_reset = {}\\n  for i = 1, #clients_queued_reset do\\n    table.insert(queued_reset, clients_queued_reset[i])\\n    table.insert(queued_reset, 0)\\n  end\\n  redis.call('hmset', client_num_queued_key, unpack(queued_reset))\\n\\n  redis.call('publish', 'b_'..id, 'blocked:')\\n\\n  refresh_expiration(now, newNextRequest, groupTimeout)\\nend\\n\\nif not blocked and not reachedHWM then\\n  redis.call('hincrby', client_num_queued_key, client, 1)\\nend\\n\\nreturn {reachedHWM, blocked, strategy}\\n\",\"update_settings.lua\":\"local args = {'hmset', settings_key}\\n\\nfor i = num_static_argv + 1, #ARGV do\\n  table.insert(args, ARGV[i])\\nend\\n\\nredis.call(unpack(args))\\n\\nprocess_tick(now, true)\\n\\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\\nrefresh_expiration(0, 0, groupTimeout)\\n\\nreturn {}\\n\",\"validate_client.lua\":\"if not redis.call('zscore', client_last_seen_key, client) then\\n  return redis.error_reply('UNKNOWN_CLIENT')\\nend\\n\\nredis.call('zadd', client_last_seen_key, now, client)\\n\",\"validate_keys.lua\":\"if not (redis.call('exists', settings_key) == 1) then\\n  return redis.error_reply('SETTINGS_KEY_NOT_FOUND')\\nend\\n\"}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 1295, "column": 19219}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1299, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/Scripts.js"],"sourcesContent":["\"use strict\";\n\nvar headers, lua, templates;\nlua = require(\"./lua.json\");\nheaders = {\n  refs: lua[\"refs.lua\"],\n  validate_keys: lua[\"validate_keys.lua\"],\n  validate_client: lua[\"validate_client.lua\"],\n  refresh_expiration: lua[\"refresh_expiration.lua\"],\n  process_tick: lua[\"process_tick.lua\"],\n  conditions_check: lua[\"conditions_check.lua\"],\n  get_time: lua[\"get_time.lua\"]\n};\n\nexports.allKeys = function (id) {\n  return [\n  /*\n  HASH\n  */\n  `b_${id}_settings`,\n  /*\n  HASH\n  job index -> weight\n  */\n  `b_${id}_job_weights`,\n  /*\n  ZSET\n  job index -> expiration\n  */\n  `b_${id}_job_expirations`,\n  /*\n  HASH\n  job index -> client\n  */\n  `b_${id}_job_clients`,\n  /*\n  ZSET\n  client -> sum running\n  */\n  `b_${id}_client_running`,\n  /*\n  HASH\n  client -> num queued\n  */\n  `b_${id}_client_num_queued`,\n  /*\n  ZSET\n  client -> last job registered\n  */\n  `b_${id}_client_last_registered`,\n  /*\n  ZSET\n  client -> last seen\n  */\n  `b_${id}_client_last_seen`];\n};\n\ntemplates = {\n  init: {\n    keys: exports.allKeys,\n    headers: [\"process_tick\"],\n    refresh_expiration: true,\n    code: lua[\"init.lua\"]\n  },\n  group_check: {\n    keys: exports.allKeys,\n    headers: [],\n    refresh_expiration: false,\n    code: lua[\"group_check.lua\"]\n  },\n  register_client: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\"],\n    refresh_expiration: false,\n    code: lua[\"register_client.lua\"]\n  },\n  blacklist_client: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\"],\n    refresh_expiration: false,\n    code: lua[\"blacklist_client.lua\"]\n  },\n  heartbeat: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: false,\n    code: lua[\"heartbeat.lua\"]\n  },\n  update_settings: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: true,\n    code: lua[\"update_settings.lua\"]\n  },\n  running: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: false,\n    code: lua[\"running.lua\"]\n  },\n  queued: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\"],\n    refresh_expiration: false,\n    code: lua[\"queued.lua\"]\n  },\n  done: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: false,\n    code: lua[\"done.lua\"]\n  },\n  check: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\", \"conditions_check\"],\n    refresh_expiration: false,\n    code: lua[\"check.lua\"]\n  },\n  submit: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\", \"conditions_check\"],\n    refresh_expiration: true,\n    code: lua[\"submit.lua\"]\n  },\n  register: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\", \"conditions_check\"],\n    refresh_expiration: true,\n    code: lua[\"register.lua\"]\n  },\n  free: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: true,\n    code: lua[\"free.lua\"]\n  },\n  current_reservoir: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: false,\n    code: lua[\"current_reservoir.lua\"]\n  },\n  increment_reservoir: {\n    keys: exports.allKeys,\n    headers: [\"validate_keys\", \"validate_client\", \"process_tick\"],\n    refresh_expiration: true,\n    code: lua[\"increment_reservoir.lua\"]\n  }\n};\nexports.names = Object.keys(templates);\n\nexports.keys = function (name, id) {\n  return templates[name].keys(id);\n};\n\nexports.payload = function (name) {\n  var template;\n  template = templates[name];\n  return Array.prototype.concat(headers.refs, template.headers.map(function (h) {\n    return headers[h];\n  }), template.refresh_expiration ? headers.refresh_expiration : \"\", template.code).join(\"\\n\");\n};"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1505, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/RedisConnection.js"],"sourcesContent":["\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Events, RedisConnection, Scripts, parser;\nparser = require(\"./parser\");\nEvents = require(\"./Events\");\nScripts = require(\"./Scripts\");\n\nRedisConnection = function () {\n  class RedisConnection {\n    constructor(options = {}) {\n      parser.load(options, this.defaults, this);\n\n      if (this.Redis == null) {\n        this.Redis = eval(\"require\")(\"redis\"); // Obfuscated or else Webpack/Angular will try to inline the optional redis module. To override this behavior: pass the redis module to Bottleneck as the 'Redis' option.\n      }\n\n      if (this.Events == null) {\n        this.Events = new Events(this);\n      }\n\n      this.terminated = false;\n\n      if (this.client == null) {\n        this.client = this.Redis.createClient(this.clientOptions);\n      }\n\n      this.subscriber = this.client.duplicate();\n      this.limiters = {};\n      this.shas = {};\n      this.ready = this.Promise.all([this._setup(this.client, false), this._setup(this.subscriber, true)]).then(() => {\n        return this._loadScripts();\n      }).then(() => {\n        return {\n          client: this.client,\n          subscriber: this.subscriber\n        };\n      });\n    }\n\n    _setup(client, sub) {\n      client.setMaxListeners(0);\n      return new this.Promise((resolve, reject) => {\n        client.on(\"error\", e => {\n          return this.Events.trigger(\"error\", e);\n        });\n\n        if (sub) {\n          client.on(\"message\", (channel, message) => {\n            var ref;\n            return (ref = this.limiters[channel]) != null ? ref._store.onMessage(channel, message) : void 0;\n          });\n        }\n\n        if (client.ready) {\n          return resolve();\n        } else {\n          return client.once(\"ready\", resolve);\n        }\n      });\n    }\n\n    _loadScript(name) {\n      return new this.Promise((resolve, reject) => {\n        var payload;\n        payload = Scripts.payload(name);\n        return this.client.multi([[\"script\", \"load\", payload]]).exec((err, replies) => {\n          if (err != null) {\n            return reject(err);\n          }\n\n          this.shas[name] = replies[0];\n          return resolve(replies[0]);\n        });\n      });\n    }\n\n    _loadScripts() {\n      return this.Promise.all(Scripts.names.map(k => {\n        return this._loadScript(k);\n      }));\n    }\n\n    __runCommand__(cmd) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        yield _this.ready;\n        return new _this.Promise((resolve, reject) => {\n          return _this.client.multi([cmd]).exec_atomic(function (err, replies) {\n            if (err != null) {\n              return reject(err);\n            } else {\n              return resolve(replies[0]);\n            }\n          });\n        });\n      })();\n    }\n\n    __addLimiter__(instance) {\n      return this.Promise.all([instance.channel(), instance.channel_client()].map(channel => {\n        return new this.Promise((resolve, reject) => {\n          var handler;\n\n          handler = chan => {\n            if (chan === channel) {\n              this.subscriber.removeListener(\"subscribe\", handler);\n              this.limiters[channel] = instance;\n              return resolve();\n            }\n          };\n\n          this.subscriber.on(\"subscribe\", handler);\n          return this.subscriber.subscribe(channel);\n        });\n      }));\n    }\n\n    __removeLimiter__(instance) {\n      var _this2 = this;\n\n      return this.Promise.all([instance.channel(), instance.channel_client()].map(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(function* (channel) {\n          if (!_this2.terminated) {\n            yield new _this2.Promise((resolve, reject) => {\n              return _this2.subscriber.unsubscribe(channel, function (err, chan) {\n                if (err != null) {\n                  return reject(err);\n                }\n\n                if (chan === channel) {\n                  return resolve();\n                }\n              });\n            });\n          }\n\n          return delete _this2.limiters[channel];\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()));\n    }\n\n    __scriptArgs__(name, id, args, cb) {\n      var keys;\n      keys = Scripts.keys(name, id);\n      return [this.shas[name], keys.length].concat(keys, args, cb);\n    }\n\n    __scriptFn__(name) {\n      return this.client.evalsha.bind(this.client);\n    }\n\n    disconnect(flush = true) {\n      var i, k, len, ref;\n      ref = Object.keys(this.limiters);\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        k = ref[i];\n        clearInterval(this.limiters[k]._store.heartbeat);\n      }\n\n      this.limiters = {};\n      this.terminated = true;\n      this.client.end(flush);\n      this.subscriber.end(flush);\n      return this.Promise.resolve();\n    }\n\n  }\n\n  ;\n  RedisConnection.prototype.datastore = \"redis\";\n  RedisConnection.prototype.defaults = {\n    Redis: null,\n    clientOptions: {},\n    client: null,\n    Promise: Promise,\n    Events: null\n  };\n  return RedisConnection;\n}.call(void 0);\n\nmodule.exports = RedisConnection;"],"names":[],"mappings":"AAEA,SAAS,mBAAmB,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG;IAAI,IAAI;QAAE,IAAI,OAAO,GAAG,CAAC,IAAI,CAAC;QAAM,IAAI,QAAQ,KAAK,KAAK;IAAE,EAAE,OAAO,OAAO;QAAE,OAAO;QAAQ;IAAQ;IAAE,IAAI,KAAK,IAAI,EAAE;QAAE,QAAQ;IAAQ,OAAO;QAAE,QAAQ,OAAO,CAAC,OAAO,IAAI,CAAC,OAAO;IAAS;AAAE;AAExQ,SAAS,kBAAkB,EAAE;IAAI,OAAO;QAAc,IAAI,OAAO,IAAI,EAAE,OAAO;QAAW,OAAO,IAAI,QAAQ,SAAU,OAAO,EAAE,MAAM;YAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM;YAAO,SAAS,MAAM,KAAK;gBAAI,mBAAmB,KAAK,SAAS,QAAQ,OAAO,QAAQ,QAAQ;YAAQ;YAAE,SAAS,OAAO,GAAG;gBAAI,mBAAmB,KAAK,SAAS,QAAQ,OAAO,QAAQ,SAAS;YAAM;YAAE,MAAM;QAAY;IAAI;AAAG;AAEpY,IAAI,QAAQ,iBAAiB,SAAS;AACtC;AACA;AACA;AAEA,kBAAkB,CAAA;IAChB,MAAM;QACJ,YAAY,UAAU,CAAC,CAAC,CAAE;YACxB,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,QAAQ,EAAE,IAAI;YAExC,IAAI,IAAI,CAAC,KAAK,IAAI,MAAM;gBACtB,IAAI,CAAC,KAAK,GAAG,KAAK,WAAW,UAAU,yKAAyK;YAClN;YAEA,IAAI,IAAI,CAAC,MAAM,IAAI,MAAM;gBACvB,IAAI,CAAC,MAAM,GAAG,IAAI,OAAO,IAAI;YAC/B;YAEA,IAAI,CAAC,UAAU,GAAG;YAElB,IAAI,IAAI,CAAC,MAAM,IAAI,MAAM;gBACvB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa;YAC1D;YAEA,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS;YACvC,IAAI,CAAC,QAAQ,GAAG,CAAC;YACjB,IAAI,CAAC,IAAI,GAAG,CAAC;YACb,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;gBAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE;gBAAQ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE;aAAM,EAAE,IAAI,CAAC;gBACxG,OAAO,IAAI,CAAC,YAAY;YAC1B,GAAG,IAAI,CAAC;gBACN,OAAO;oBACL,QAAQ,IAAI,CAAC,MAAM;oBACnB,YAAY,IAAI,CAAC,UAAU;gBAC7B;YACF;QACF;QAEA,OAAO,MAAM,EAAE,GAAG,EAAE;YAClB,OAAO,eAAe,CAAC;YACvB,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS;gBAChC,OAAO,EAAE,CAAC,SAAS,CAAA;oBACjB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS;gBACtC;gBAEA,IAAI,KAAK;oBACP,OAAO,EAAE,CAAC,WAAW,CAAC,SAAS;wBAC7B,IAAI;wBACJ,OAAO,CAAC,MAAM,IAAI,CAAC,QAAQ,CAAC,QAAQ,KAAK,OAAO,IAAI,MAAM,CAAC,SAAS,CAAC,SAAS,WAAW,KAAK;oBAChG;gBACF;gBAEA,IAAI,OAAO,KAAK,EAAE;oBAChB,OAAO;gBACT,OAAO;oBACL,OAAO,OAAO,IAAI,CAAC,SAAS;gBAC9B;YACF;QACF;QAEA,YAAY,IAAI,EAAE;YAChB,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS;gBAChC,IAAI;gBACJ,UAAU,QAAQ,OAAO,CAAC;gBAC1B,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;oBAAC;wBAAC;wBAAU;wBAAQ;qBAAQ;iBAAC,EAAE,IAAI,CAAC,CAAC,KAAK;oBACjE,IAAI,OAAO,MAAM;wBACf,OAAO,OAAO;oBAChB;oBAEA,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,EAAE;oBAC5B,OAAO,QAAQ,OAAO,CAAC,EAAE;gBAC3B;YACF;QACF;QAEA,eAAe;YACb,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,CAAC,GAAG,CAAC,CAAA;gBACxC,OAAO,IAAI,CAAC,WAAW,CAAC;YAC1B;QACF;QAEA,eAAe,GAAG,EAAE;YAClB,IAAI,QAAQ,IAAI;YAEhB,OAAO,kBAAkB;gBACvB,MAAM,MAAM,KAAK;gBACjB,OAAO,IAAI,MAAM,OAAO,CAAC,CAAC,SAAS;oBACjC,OAAO,MAAM,MAAM,CAAC,KAAK,CAAC;wBAAC;qBAAI,EAAE,WAAW,CAAC,SAAU,GAAG,EAAE,OAAO;wBACjE,IAAI,OAAO,MAAM;4BACf,OAAO,OAAO;wBAChB,OAAO;4BACL,OAAO,QAAQ,OAAO,CAAC,EAAE;wBAC3B;oBACF;gBACF;YACF;QACF;QAEA,eAAe,QAAQ,EAAE;YACvB,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;gBAAC,SAAS,OAAO;gBAAI,SAAS,cAAc;aAAG,CAAC,GAAG,CAAC,CAAA;gBAC1E,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS;oBAChC,IAAI;oBAEJ,UAAU,CAAA;wBACR,IAAI,SAAS,SAAS;4BACpB,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,aAAa;4BAC5C,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG;4BACzB,OAAO;wBACT;oBACF;oBAEA,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,aAAa;oBAChC,OAAO,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC;gBACnC;YACF;QACF;QAEA,kBAAkB,QAAQ,EAAE;YAC1B,IAAI,SAAS,IAAI;YAEjB,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;gBAAC,SAAS,OAAO;gBAAI,SAAS,cAAc;aAAG,CAAC,GAAG,CAC3E,WAAW,GACX;gBACE,IAAI,OAAO,kBAAkB,UAAW,OAAO;oBAC7C,IAAI,CAAC,OAAO,UAAU,EAAE;wBACtB,MAAM,IAAI,OAAO,OAAO,CAAC,CAAC,SAAS;4BACjC,OAAO,OAAO,UAAU,CAAC,WAAW,CAAC,SAAS,SAAU,GAAG,EAAE,IAAI;gCAC/D,IAAI,OAAO,MAAM;oCACf,OAAO,OAAO;gCAChB;gCAEA,IAAI,SAAS,SAAS;oCACpB,OAAO;gCACT;4BACF;wBACF;oBACF;oBAEA,OAAO,OAAO,OAAO,QAAQ,CAAC,QAAQ;gBACxC;gBAEA,OAAO,SAAU,EAAE;oBACjB,OAAO,KAAK,KAAK,CAAC,IAAI,EAAE;gBAC1B;YACF;QACF;QAEA,eAAe,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE;YACjC,IAAI;YACJ,OAAO,QAAQ,IAAI,CAAC,MAAM;YAC1B,OAAO;gBAAC,IAAI,CAAC,IAAI,CAAC,KAAK;gBAAE,KAAK,MAAM;aAAC,CAAC,MAAM,CAAC,MAAM,MAAM;QAC3D;QAEA,aAAa,IAAI,EAAE;YACjB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM;QAC7C;QAEA,WAAW,QAAQ,IAAI,EAAE;YACvB,IAAI,GAAG,GAAG,KAAK;YACf,MAAM,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ;YAE/B,IAAK,IAAI,GAAG,MAAM,IAAI,MAAM,EAAE,IAAI,KAAK,IAAK;gBAC1C,IAAI,GAAG,CAAC,EAAE;gBACV,cAAc,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,SAAS;YACjD;YAEA,IAAI,CAAC,QAAQ,GAAG,CAAC;YACjB,IAAI,CAAC,UAAU,GAAG;YAClB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC;YAChB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC;YACpB,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO;QAC7B;IAEF;;IAGA,gBAAgB,SAAS,CAAC,SAAS,GAAG;IACtC,gBAAgB,SAAS,CAAC,QAAQ,GAAG;QACnC,OAAO;QACP,eAAe,CAAC;QAChB,QAAQ;QACR,SAAS;QACT,QAAQ;IACV;IACA,OAAO;AACT,CAAA,EAAE,IAAI,CAAC,KAAK;AAEZ,OAAO,OAAO,GAAG","ignoreList":[0]}},
    {"offset": {"line": 1713, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/IORedisConnection.js"],"sourcesContent":["\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Events, IORedisConnection, Scripts, parser;\nparser = require(\"./parser\");\nEvents = require(\"./Events\");\nScripts = require(\"./Scripts\");\n\nIORedisConnection = function () {\n  class IORedisConnection {\n    constructor(options = {}) {\n      parser.load(options, this.defaults, this);\n\n      if (this.Redis == null) {\n        this.Redis = eval(\"require\")(\"ioredis\"); // Obfuscated or else Webpack/Angular will try to inline the optional ioredis module. To override this behavior: pass the ioredis module to Bottleneck as the 'Redis' option.\n      }\n\n      if (this.Events == null) {\n        this.Events = new Events(this);\n      }\n\n      this.terminated = false;\n\n      if (this.clusterNodes != null) {\n        this.client = new this.Redis.Cluster(this.clusterNodes, this.clientOptions);\n        this.subscriber = new this.Redis.Cluster(this.clusterNodes, this.clientOptions);\n      } else if (this.client != null && this.client.duplicate == null) {\n        this.subscriber = new this.Redis.Cluster(this.client.startupNodes, this.client.options);\n      } else {\n        if (this.client == null) {\n          this.client = new this.Redis(this.clientOptions);\n        }\n\n        this.subscriber = this.client.duplicate();\n      }\n\n      this.limiters = {};\n      this.ready = this.Promise.all([this._setup(this.client, false), this._setup(this.subscriber, true)]).then(() => {\n        this._loadScripts();\n\n        return {\n          client: this.client,\n          subscriber: this.subscriber\n        };\n      });\n    }\n\n    _setup(client, sub) {\n      client.setMaxListeners(0);\n      return new this.Promise((resolve, reject) => {\n        client.on(\"error\", e => {\n          return this.Events.trigger(\"error\", e);\n        });\n\n        if (sub) {\n          client.on(\"message\", (channel, message) => {\n            var ref;\n            return (ref = this.limiters[channel]) != null ? ref._store.onMessage(channel, message) : void 0;\n          });\n        }\n\n        if (client.status === \"ready\") {\n          return resolve();\n        } else {\n          return client.once(\"ready\", resolve);\n        }\n      });\n    }\n\n    _loadScripts() {\n      return Scripts.names.forEach(name => {\n        return this.client.defineCommand(name, {\n          lua: Scripts.payload(name)\n        });\n      });\n    }\n\n    __runCommand__(cmd) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var _, deleted;\n\n        yield _this.ready;\n\n        var _ref = yield _this.client.pipeline([cmd]).exec();\n\n        var _ref2 = _slicedToArray(_ref, 1);\n\n        var _ref2$ = _slicedToArray(_ref2[0], 2);\n\n        _ = _ref2$[0];\n        deleted = _ref2$[1];\n        return deleted;\n      })();\n    }\n\n    __addLimiter__(instance) {\n      return this.Promise.all([instance.channel(), instance.channel_client()].map(channel => {\n        return new this.Promise((resolve, reject) => {\n          return this.subscriber.subscribe(channel, () => {\n            this.limiters[channel] = instance;\n            return resolve();\n          });\n        });\n      }));\n    }\n\n    __removeLimiter__(instance) {\n      var _this2 = this;\n\n      return [instance.channel(), instance.channel_client()].forEach(\n      /*#__PURE__*/\n      function () {\n        var _ref3 = _asyncToGenerator(function* (channel) {\n          if (!_this2.terminated) {\n            yield _this2.subscriber.unsubscribe(channel);\n          }\n\n          return delete _this2.limiters[channel];\n        });\n\n        return function (_x) {\n          return _ref3.apply(this, arguments);\n        };\n      }());\n    }\n\n    __scriptArgs__(name, id, args, cb) {\n      var keys;\n      keys = Scripts.keys(name, id);\n      return [keys.length].concat(keys, args, cb);\n    }\n\n    __scriptFn__(name) {\n      return this.client[name].bind(this.client);\n    }\n\n    disconnect(flush = true) {\n      var i, k, len, ref;\n      ref = Object.keys(this.limiters);\n\n      for (i = 0, len = ref.length; i < len; i++) {\n        k = ref[i];\n        clearInterval(this.limiters[k]._store.heartbeat);\n      }\n\n      this.limiters = {};\n      this.terminated = true;\n\n      if (flush) {\n        return this.Promise.all([this.client.quit(), this.subscriber.quit()]);\n      } else {\n        this.client.disconnect();\n        this.subscriber.disconnect();\n        return this.Promise.resolve();\n      }\n    }\n\n  }\n\n  ;\n  IORedisConnection.prototype.datastore = \"ioredis\";\n  IORedisConnection.prototype.defaults = {\n    Redis: null,\n    clientOptions: {},\n    clusterNodes: null,\n    client: null,\n    Promise: Promise,\n    Events: null\n  };\n  return IORedisConnection;\n}.call(void 0);\n\nmodule.exports = IORedisConnection;"],"names":[],"mappings":"AAEA,SAAS,eAAe,GAAG,EAAE,CAAC;IAAI,OAAO,gBAAgB,QAAQ,sBAAsB,KAAK,MAAM;AAAoB;AAEtH,SAAS;IAAqB,MAAM,IAAI,UAAU;AAAyD;AAE3G,SAAS,sBAAsB,GAAG,EAAE,CAAC;IAAI,IAAI,OAAO,EAAE;IAAE,IAAI,KAAK;IAAM,IAAI,KAAK;IAAO,IAAI,KAAK;IAAW,IAAI;QAAE,IAAK,IAAI,KAAK,GAAG,CAAC,OAAO,QAAQ,CAAC,IAAI,IAAI,CAAC,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,EAAE,EAAE,IAAI,GAAG,KAAK,KAAM;YAAE,KAAK,IAAI,CAAC,GAAG,KAAK;YAAG,IAAI,KAAK,KAAK,MAAM,KAAK,GAAG;QAAO;IAAE,EAAE,OAAO,KAAK;QAAE,KAAK;QAAM,KAAK;IAAK,SAAU;QAAE,IAAI;YAAE,IAAI,CAAC,MAAM,EAAE,CAAC,SAAS,IAAI,MAAM,EAAE,CAAC,SAAS;QAAI,SAAU;YAAE,IAAI,IAAI,MAAM;QAAI;IAAE;IAAE,OAAO;AAAM;AAExZ,SAAS,gBAAgB,GAAG;IAAI,IAAI,MAAM,OAAO,CAAC,MAAM,OAAO;AAAK;AAEpE,SAAS,mBAAmB,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG;IAAI,IAAI;QAAE,IAAI,OAAO,GAAG,CAAC,IAAI,CAAC;QAAM,IAAI,QAAQ,KAAK,KAAK;IAAE,EAAE,OAAO,OAAO;QAAE,OAAO;QAAQ;IAAQ;IAAE,IAAI,KAAK,IAAI,EAAE;QAAE,QAAQ;IAAQ,OAAO;QAAE,QAAQ,OAAO,CAAC,OAAO,IAAI,CAAC,OAAO;IAAS;AAAE;AAExQ,SAAS,kBAAkB,EAAE;IAAI,OAAO;QAAc,IAAI,OAAO,IAAI,EAAE,OAAO;QAAW,OAAO,IAAI,QAAQ,SAAU,OAAO,EAAE,MAAM;YAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM;YAAO,SAAS,MAAM,KAAK;gBAAI,mBAAmB,KAAK,SAAS,QAAQ,OAAO,QAAQ,QAAQ;YAAQ;YAAE,SAAS,OAAO,GAAG;gBAAI,mBAAmB,KAAK,SAAS,QAAQ,OAAO,QAAQ,SAAS;YAAM;YAAE,MAAM;QAAY;IAAI;AAAG;AAEpY,IAAI,QAAQ,mBAAmB,SAAS;AACxC;AACA;AACA;AAEA,oBAAoB,CAAA;IAClB,MAAM;QACJ,YAAY,UAAU,CAAC,CAAC,CAAE;YACxB,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,QAAQ,EAAE,IAAI;YAExC,IAAI,IAAI,CAAC,KAAK,IAAI,MAAM;gBACtB,IAAI,CAAC,KAAK,GAAG,KAAK,WAAW,YAAY,6KAA6K;YACxN;YAEA,IAAI,IAAI,CAAC,MAAM,IAAI,MAAM;gBACvB,IAAI,CAAC,MAAM,GAAG,IAAI,OAAO,IAAI;YAC/B;YAEA,IAAI,CAAC,UAAU,GAAG;YAElB,IAAI,IAAI,CAAC,YAAY,IAAI,MAAM;gBAC7B,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,aAAa;gBAC1E,IAAI,CAAC,UAAU,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,aAAa;YAChF,OAAO,IAAI,IAAI,CAAC,MAAM,IAAI,QAAQ,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,MAAM;gBAC/D,IAAI,CAAC,UAAU,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,OAAO;YACxF,OAAO;gBACL,IAAI,IAAI,CAAC,MAAM,IAAI,MAAM;oBACvB,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,aAAa;gBACjD;gBAEA,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS;YACzC;YAEA,IAAI,CAAC,QAAQ,GAAG,CAAC;YACjB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;gBAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE;gBAAQ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE;aAAM,EAAE,IAAI,CAAC;gBACxG,IAAI,CAAC,YAAY;gBAEjB,OAAO;oBACL,QAAQ,IAAI,CAAC,MAAM;oBACnB,YAAY,IAAI,CAAC,UAAU;gBAC7B;YACF;QACF;QAEA,OAAO,MAAM,EAAE,GAAG,EAAE;YAClB,OAAO,eAAe,CAAC;YACvB,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS;gBAChC,OAAO,EAAE,CAAC,SAAS,CAAA;oBACjB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS;gBACtC;gBAEA,IAAI,KAAK;oBACP,OAAO,EAAE,CAAC,WAAW,CAAC,SAAS;wBAC7B,IAAI;wBACJ,OAAO,CAAC,MAAM,IAAI,CAAC,QAAQ,CAAC,QAAQ,KAAK,OAAO,IAAI,MAAM,CAAC,SAAS,CAAC,SAAS,WAAW,KAAK;oBAChG;gBACF;gBAEA,IAAI,OAAO,MAAM,KAAK,SAAS;oBAC7B,OAAO;gBACT,OAAO;oBACL,OAAO,OAAO,IAAI,CAAC,SAAS;gBAC9B;YACF;QACF;QAEA,eAAe;YACb,OAAO,QAAQ,KAAK,CAAC,OAAO,CAAC,CAAA;gBAC3B,OAAO,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,MAAM;oBACrC,KAAK,QAAQ,OAAO,CAAC;gBACvB;YACF;QACF;QAEA,eAAe,GAAG,EAAE;YAClB,IAAI,QAAQ,IAAI;YAEhB,OAAO,kBAAkB;gBACvB,IAAI,GAAG;gBAEP,MAAM,MAAM,KAAK;gBAEjB,IAAI,OAAO,MAAM,MAAM,MAAM,CAAC,QAAQ,CAAC;oBAAC;iBAAI,EAAE,IAAI;gBAElD,IAAI,QAAQ,eAAe,MAAM;gBAEjC,IAAI,SAAS,eAAe,KAAK,CAAC,EAAE,EAAE;gBAEtC,IAAI,MAAM,CAAC,EAAE;gBACb,UAAU,MAAM,CAAC,EAAE;gBACnB,OAAO;YACT;QACF;QAEA,eAAe,QAAQ,EAAE;YACvB,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;gBAAC,SAAS,OAAO;gBAAI,SAAS,cAAc;aAAG,CAAC,GAAG,CAAC,CAAA;gBAC1E,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS;oBAChC,OAAO,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,SAAS;wBACxC,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG;wBACzB,OAAO;oBACT;gBACF;YACF;QACF;QAEA,kBAAkB,QAAQ,EAAE;YAC1B,IAAI,SAAS,IAAI;YAEjB,OAAO;gBAAC,SAAS,OAAO;gBAAI,SAAS,cAAc;aAAG,CAAC,OAAO,CAC9D,WAAW,GACX;gBACE,IAAI,QAAQ,kBAAkB,UAAW,OAAO;oBAC9C,IAAI,CAAC,OAAO,UAAU,EAAE;wBACtB,MAAM,OAAO,UAAU,CAAC,WAAW,CAAC;oBACtC;oBAEA,OAAO,OAAO,OAAO,QAAQ,CAAC,QAAQ;gBACxC;gBAEA,OAAO,SAAU,EAAE;oBACjB,OAAO,MAAM,KAAK,CAAC,IAAI,EAAE;gBAC3B;YACF;QACF;QAEA,eAAe,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE;YACjC,IAAI;YACJ,OAAO,QAAQ,IAAI,CAAC,MAAM;YAC1B,OAAO;gBAAC,KAAK,MAAM;aAAC,CAAC,MAAM,CAAC,MAAM,MAAM;QAC1C;QAEA,aAAa,IAAI,EAAE;YACjB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM;QAC3C;QAEA,WAAW,QAAQ,IAAI,EAAE;YACvB,IAAI,GAAG,GAAG,KAAK;YACf,MAAM,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ;YAE/B,IAAK,IAAI,GAAG,MAAM,IAAI,MAAM,EAAE,IAAI,KAAK,IAAK;gBAC1C,IAAI,GAAG,CAAC,EAAE;gBACV,cAAc,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,SAAS;YACjD;YAEA,IAAI,CAAC,QAAQ,GAAG,CAAC;YACjB,IAAI,CAAC,UAAU,GAAG;YAElB,IAAI,OAAO;gBACT,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;oBAAC,IAAI,CAAC,MAAM,CAAC,IAAI;oBAAI,IAAI,CAAC,UAAU,CAAC,IAAI;iBAAG;YACtE,OAAO;gBACL,IAAI,CAAC,MAAM,CAAC,UAAU;gBACtB,IAAI,CAAC,UAAU,CAAC,UAAU;gBAC1B,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO;YAC7B;QACF;IAEF;;IAGA,kBAAkB,SAAS,CAAC,SAAS,GAAG;IACxC,kBAAkB,SAAS,CAAC,QAAQ,GAAG;QACrC,OAAO;QACP,eAAe,CAAC;QAChB,cAAc;QACd,QAAQ;QACR,SAAS;QACT,QAAQ;IACV;IACA,OAAO;AACT,CAAA,EAAE,IAAI,CAAC,KAAK;AAEZ,OAAO,OAAO,GAAG","ignoreList":[0]}},
    {"offset": {"line": 1930, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/RedisDatastore.js"],"sourcesContent":["\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar BottleneckError, IORedisConnection, RedisConnection, RedisDatastore, parser;\nparser = require(\"./parser\");\nBottleneckError = require(\"./BottleneckError\");\nRedisConnection = require(\"./RedisConnection\");\nIORedisConnection = require(\"./IORedisConnection\");\nRedisDatastore = class RedisDatastore {\n  constructor(instance, storeOptions, storeInstanceOptions) {\n    this.instance = instance;\n    this.storeOptions = storeOptions;\n    this.originalId = this.instance.id;\n    this.clientId = this.instance._randomIndex();\n    parser.load(storeInstanceOptions, storeInstanceOptions, this);\n    this.clients = {};\n    this.capacityPriorityCounters = {};\n    this.sharedConnection = this.connection != null;\n\n    if (this.connection == null) {\n      this.connection = this.instance.datastore === \"redis\" ? new RedisConnection({\n        Redis: this.Redis,\n        clientOptions: this.clientOptions,\n        Promise: this.Promise,\n        Events: this.instance.Events\n      }) : this.instance.datastore === \"ioredis\" ? new IORedisConnection({\n        Redis: this.Redis,\n        clientOptions: this.clientOptions,\n        clusterNodes: this.clusterNodes,\n        Promise: this.Promise,\n        Events: this.instance.Events\n      }) : void 0;\n    }\n\n    this.instance.connection = this.connection;\n    this.instance.datastore = this.connection.datastore;\n    this.ready = this.connection.ready.then(clients => {\n      this.clients = clients;\n      return this.runScript(\"init\", this.prepareInitSettings(this.clearDatastore));\n    }).then(() => {\n      return this.connection.__addLimiter__(this.instance);\n    }).then(() => {\n      return this.runScript(\"register_client\", [this.instance.queued()]);\n    }).then(() => {\n      var base;\n\n      if (typeof (base = this.heartbeat = setInterval(() => {\n        return this.runScript(\"heartbeat\", []).catch(e => {\n          return this.instance.Events.trigger(\"error\", e);\n        });\n      }, this.heartbeatInterval)).unref === \"function\") {\n        base.unref();\n      }\n\n      return this.clients;\n    });\n  }\n\n  __publish__(message) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var client;\n\n      var _ref = yield _this.ready;\n\n      client = _ref.client;\n      return client.publish(_this.instance.channel(), `message:${message.toString()}`);\n    })();\n  }\n\n  onMessage(channel, message) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var capacity, counter, data, drained, e, newCapacity, pos, priorityClient, rawCapacity, type;\n\n      try {\n        pos = message.indexOf(\":\");\n        var _ref2 = [message.slice(0, pos), message.slice(pos + 1)];\n        type = _ref2[0];\n        data = _ref2[1];\n\n        if (type === \"capacity\") {\n          return yield _this2.instance._drainAll(data.length > 0 ? ~~data : void 0);\n        } else if (type === \"capacity-priority\") {\n          var _data$split = data.split(\":\");\n\n          var _data$split2 = _slicedToArray(_data$split, 3);\n\n          rawCapacity = _data$split2[0];\n          priorityClient = _data$split2[1];\n          counter = _data$split2[2];\n          capacity = rawCapacity.length > 0 ? ~~rawCapacity : void 0;\n\n          if (priorityClient === _this2.clientId) {\n            drained = yield _this2.instance._drainAll(capacity);\n            newCapacity = capacity != null ? capacity - (drained || 0) : \"\";\n            return yield _this2.clients.client.publish(_this2.instance.channel(), `capacity-priority:${newCapacity}::${counter}`);\n          } else if (priorityClient === \"\") {\n            clearTimeout(_this2.capacityPriorityCounters[counter]);\n            delete _this2.capacityPriorityCounters[counter];\n            return _this2.instance._drainAll(capacity);\n          } else {\n            return _this2.capacityPriorityCounters[counter] = setTimeout(\n            /*#__PURE__*/\n            _asyncToGenerator(function* () {\n              var e;\n\n              try {\n                delete _this2.capacityPriorityCounters[counter];\n                yield _this2.runScript(\"blacklist_client\", [priorityClient]);\n                return yield _this2.instance._drainAll(capacity);\n              } catch (error) {\n                e = error;\n                return _this2.instance.Events.trigger(\"error\", e);\n              }\n            }), 1000);\n          }\n        } else if (type === \"message\") {\n          return _this2.instance.Events.trigger(\"message\", data);\n        } else if (type === \"blocked\") {\n          return yield _this2.instance._dropAllQueued();\n        }\n      } catch (error) {\n        e = error;\n        return _this2.instance.Events.trigger(\"error\", e);\n      }\n    })();\n  }\n\n  __disconnect__(flush) {\n    clearInterval(this.heartbeat);\n\n    if (this.sharedConnection) {\n      return this.connection.__removeLimiter__(this.instance);\n    } else {\n      return this.connection.disconnect(flush);\n    }\n  }\n\n  runScript(name, args) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!(name === \"init\" || name === \"register_client\")) {\n        yield _this3.ready;\n      }\n\n      return new _this3.Promise((resolve, reject) => {\n        var all_args, arr;\n        all_args = [Date.now(), _this3.clientId].concat(args);\n\n        _this3.instance.Events.trigger(\"debug\", `Calling Redis script: ${name}.lua`, all_args);\n\n        arr = _this3.connection.__scriptArgs__(name, _this3.originalId, all_args, function (err, replies) {\n          if (err != null) {\n            return reject(err);\n          }\n\n          return resolve(replies);\n        });\n        return _this3.connection.__scriptFn__(name)(...arr);\n      }).catch(e => {\n        if (e.message === \"SETTINGS_KEY_NOT_FOUND\") {\n          if (name === \"heartbeat\") {\n            return _this3.Promise.resolve();\n          } else {\n            return _this3.runScript(\"init\", _this3.prepareInitSettings(false)).then(() => {\n              return _this3.runScript(name, args);\n            });\n          }\n        } else if (e.message === \"UNKNOWN_CLIENT\") {\n          return _this3.runScript(\"register_client\", [_this3.instance.queued()]).then(() => {\n            return _this3.runScript(name, args);\n          });\n        } else {\n          return _this3.Promise.reject(e);\n        }\n      });\n    })();\n  }\n\n  prepareArray(arr) {\n    var i, len, results, x;\n    results = [];\n\n    for (i = 0, len = arr.length; i < len; i++) {\n      x = arr[i];\n      results.push(x != null ? x.toString() : \"\");\n    }\n\n    return results;\n  }\n\n  prepareObject(obj) {\n    var arr, k, v;\n    arr = [];\n\n    for (k in obj) {\n      v = obj[k];\n      arr.push(k, v != null ? v.toString() : \"\");\n    }\n\n    return arr;\n  }\n\n  prepareInitSettings(clear) {\n    var args;\n    args = this.prepareObject(Object.assign({}, this.storeOptions, {\n      id: this.originalId,\n      version: this.instance.version,\n      groupTimeout: this.timeout,\n      clientTimeout: this.clientTimeout\n    }));\n    args.unshift(clear ? 1 : 0, this.instance.version);\n    return args;\n  }\n\n  convertBool(b) {\n    return !!b;\n  }\n\n  __updateSettings__(options) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this4.runScript(\"update_settings\", _this4.prepareObject(options));\n      return parser.overwrite(options, options, _this4.storeOptions);\n    })();\n  }\n\n  __running__() {\n    return this.runScript(\"running\", []);\n  }\n\n  __queued__() {\n    return this.runScript(\"queued\", []);\n  }\n\n  __done__() {\n    return this.runScript(\"done\", []);\n  }\n\n  __groupCheck__() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this5.convertBool((yield _this5.runScript(\"group_check\", [])));\n    })();\n  }\n\n  __incrementReservoir__(incr) {\n    return this.runScript(\"increment_reservoir\", [incr]);\n  }\n\n  __currentReservoir__() {\n    return this.runScript(\"current_reservoir\", []);\n  }\n\n  __check__(weight) {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this6.convertBool((yield _this6.runScript(\"check\", _this6.prepareArray([weight]))));\n    })();\n  }\n\n  __register__(index, weight, expiration) {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      var reservoir, success, wait;\n\n      var _ref4 = yield _this7.runScript(\"register\", _this7.prepareArray([index, weight, expiration]));\n\n      var _ref5 = _slicedToArray(_ref4, 3);\n\n      success = _ref5[0];\n      wait = _ref5[1];\n      reservoir = _ref5[2];\n      return {\n        success: _this7.convertBool(success),\n        wait,\n        reservoir\n      };\n    })();\n  }\n\n  __submit__(queueLength, weight) {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      var blocked, e, maxConcurrent, overweight, reachedHWM, strategy;\n\n      try {\n        var _ref6 = yield _this8.runScript(\"submit\", _this8.prepareArray([queueLength, weight]));\n\n        var _ref7 = _slicedToArray(_ref6, 3);\n\n        reachedHWM = _ref7[0];\n        blocked = _ref7[1];\n        strategy = _ref7[2];\n        return {\n          reachedHWM: _this8.convertBool(reachedHWM),\n          blocked: _this8.convertBool(blocked),\n          strategy\n        };\n      } catch (error) {\n        e = error;\n\n        if (e.message.indexOf(\"OVERWEIGHT\") === 0) {\n          var _e$message$split = e.message.split(\":\");\n\n          var _e$message$split2 = _slicedToArray(_e$message$split, 3);\n\n          overweight = _e$message$split2[0];\n          weight = _e$message$split2[1];\n          maxConcurrent = _e$message$split2[2];\n          throw new BottleneckError(`Impossible to add a job having a weight of ${weight} to a limiter having a maxConcurrent setting of ${maxConcurrent}`);\n        } else {\n          throw e;\n        }\n      }\n    })();\n  }\n\n  __free__(index, weight) {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      var running;\n      running = yield _this9.runScript(\"free\", _this9.prepareArray([index]));\n      return {\n        running\n      };\n    })();\n  }\n\n};\nmodule.exports = RedisDatastore;"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2296, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/States.js"],"sourcesContent":["\"use strict\";\n\nvar BottleneckError, States;\nBottleneckError = require(\"./BottleneckError\");\nStates = class States {\n  constructor(status1) {\n    this.status = status1;\n    this._jobs = {};\n    this.counts = this.status.map(function () {\n      return 0;\n    });\n  }\n\n  next(id) {\n    var current, next;\n    current = this._jobs[id];\n    next = current + 1;\n\n    if (current != null && next < this.status.length) {\n      this.counts[current]--;\n      this.counts[next]++;\n      return this._jobs[id]++;\n    } else if (current != null) {\n      this.counts[current]--;\n      return delete this._jobs[id];\n    }\n  }\n\n  start(id) {\n    var initial;\n    initial = 0;\n    this._jobs[id] = initial;\n    return this.counts[initial]++;\n  }\n\n  remove(id) {\n    var current;\n    current = this._jobs[id];\n\n    if (current != null) {\n      this.counts[current]--;\n      delete this._jobs[id];\n    }\n\n    return current != null;\n  }\n\n  jobStatus(id) {\n    var ref;\n    return (ref = this.status[this._jobs[id]]) != null ? ref : null;\n  }\n\n  statusJobs(status) {\n    var k, pos, ref, results, v;\n\n    if (status != null) {\n      pos = this.status.indexOf(status);\n\n      if (pos < 0) {\n        throw new BottleneckError(`status must be one of ${this.status.join(', ')}`);\n      }\n\n      ref = this._jobs;\n      results = [];\n\n      for (k in ref) {\n        v = ref[k];\n\n        if (v === pos) {\n          results.push(k);\n        }\n      }\n\n      return results;\n    } else {\n      return Object.keys(this._jobs);\n    }\n  }\n\n  statusCounts() {\n    return this.counts.reduce((acc, v, i) => {\n      acc[this.status[i]] = v;\n      return acc;\n    }, {});\n  }\n\n};\nmodule.exports = States;"],"names":[],"mappings":"AAEA,IAAI,iBAAiB;AACrB;AACA,SAAS,MAAM;IACb,YAAY,OAAO,CAAE;QACnB,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,KAAK,GAAG,CAAC;QACd,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC;YAC5B,OAAO;QACT;IACF;IAEA,KAAK,EAAE,EAAE;QACP,IAAI,SAAS;QACb,UAAU,IAAI,CAAC,KAAK,CAAC,GAAG;QACxB,OAAO,UAAU;QAEjB,IAAI,WAAW,QAAQ,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;YAChD,IAAI,CAAC,MAAM,CAAC,QAAQ;YACpB,IAAI,CAAC,MAAM,CAAC,KAAK;YACjB,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG;QACvB,OAAO,IAAI,WAAW,MAAM;YAC1B,IAAI,CAAC,MAAM,CAAC,QAAQ;YACpB,OAAO,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG;QAC9B;IACF;IAEA,MAAM,EAAE,EAAE;QACR,IAAI;QACJ,UAAU;QACV,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG;QACjB,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ;IAC7B;IAEA,OAAO,EAAE,EAAE;QACT,IAAI;QACJ,UAAU,IAAI,CAAC,KAAK,CAAC,GAAG;QAExB,IAAI,WAAW,MAAM;YACnB,IAAI,CAAC,MAAM,CAAC,QAAQ;YACpB,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG;QACvB;QAEA,OAAO,WAAW;IACpB;IAEA,UAAU,EAAE,EAAE;QACZ,IAAI;QACJ,OAAO,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,OAAO,MAAM;IAC7D;IAEA,WAAW,MAAM,EAAE;QACjB,IAAI,GAAG,KAAK,KAAK,SAAS;QAE1B,IAAI,UAAU,MAAM;YAClB,MAAM,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;YAE1B,IAAI,MAAM,GAAG;gBACX,MAAM,IAAI,gBAAgB,CAAC,sBAAsB,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO;YAC7E;YAEA,MAAM,IAAI,CAAC,KAAK;YAChB,UAAU,EAAE;YAEZ,IAAK,KAAK,IAAK;gBACb,IAAI,GAAG,CAAC,EAAE;gBAEV,IAAI,MAAM,KAAK;oBACb,QAAQ,IAAI,CAAC;gBACf;YACF;YAEA,OAAO;QACT,OAAO;YACL,OAAO,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK;QAC/B;IACF;IAEA,eAAe;QACb,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,KAAK,GAAG;YACjC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG;YACtB,OAAO;QACT,GAAG,CAAC;IACN;AAEF;AACA,OAAO,OAAO,GAAG","ignoreList":[0]}},
    {"offset": {"line": 2370, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/Sync.js"],"sourcesContent":["\"use strict\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar DLList, Sync;\nDLList = require(\"./DLList\");\nSync = class Sync {\n  constructor(name, Promise) {\n    this.schedule = this.schedule.bind(this);\n    this.name = name;\n    this.Promise = Promise;\n    this._running = 0;\n    this._queue = new DLList();\n  }\n\n  isEmpty() {\n    return this._queue.length === 0;\n  }\n\n  _tryToRun() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      var args, cb, error, reject, resolve, returned, task;\n\n      if (_this._running < 1 && _this._queue.length > 0) {\n        _this._running++;\n\n        var _this$_queue$shift = _this._queue.shift();\n\n        task = _this$_queue$shift.task;\n        args = _this$_queue$shift.args;\n        resolve = _this$_queue$shift.resolve;\n        reject = _this$_queue$shift.reject;\n        cb = yield _asyncToGenerator(function* () {\n          try {\n            returned = yield task(...args);\n            return function () {\n              return resolve(returned);\n            };\n          } catch (error1) {\n            error = error1;\n            return function () {\n              return reject(error);\n            };\n          }\n        })();\n        _this._running--;\n\n        _this._tryToRun();\n\n        return cb();\n      }\n    })();\n  }\n\n  schedule(task, ...args) {\n    var promise, reject, resolve;\n    resolve = reject = null;\n    promise = new this.Promise(function (_resolve, _reject) {\n      resolve = _resolve;\n      return reject = _reject;\n    });\n\n    this._queue.push({\n      task,\n      args,\n      resolve,\n      reject\n    });\n\n    this._tryToRun();\n\n    return promise;\n  }\n\n};\nmodule.exports = Sync;"],"names":[],"mappings":"AAEA,SAAS,mBAAmB,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG;IAAI,IAAI;QAAE,IAAI,OAAO,GAAG,CAAC,IAAI,CAAC;QAAM,IAAI,QAAQ,KAAK,KAAK;IAAE,EAAE,OAAO,OAAO;QAAE,OAAO;QAAQ;IAAQ;IAAE,IAAI,KAAK,IAAI,EAAE;QAAE,QAAQ;IAAQ,OAAO;QAAE,QAAQ,OAAO,CAAC,OAAO,IAAI,CAAC,OAAO;IAAS;AAAE;AAExQ,SAAS,kBAAkB,EAAE;IAAI,OAAO;QAAc,IAAI,OAAO,IAAI,EAAE,OAAO;QAAW,OAAO,IAAI,QAAQ,SAAU,OAAO,EAAE,MAAM;YAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM;YAAO,SAAS,MAAM,KAAK;gBAAI,mBAAmB,KAAK,SAAS,QAAQ,OAAO,QAAQ,QAAQ;YAAQ;YAAE,SAAS,OAAO,GAAG;gBAAI,mBAAmB,KAAK,SAAS,QAAQ,OAAO,QAAQ,SAAS;YAAM;YAAE,MAAM;QAAY;IAAI;AAAG;AAEpY,IAAI,QAAQ;AACZ;AACA,OAAO,MAAM;IACX,YAAY,IAAI,EAAE,QAAO,CAAE;QACzB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI;QACvC,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,MAAM,GAAG,IAAI;IACpB;IAEA,UAAU;QACR,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK;IAChC;IAEA,YAAY;QACV,IAAI,QAAQ,IAAI;QAEhB,OAAO,kBAAkB;YACvB,IAAI,MAAM,IAAI,OAAO,QAAQ,SAAS,UAAU;YAEhD,IAAI,MAAM,QAAQ,GAAG,KAAK,MAAM,MAAM,CAAC,MAAM,GAAG,GAAG;gBACjD,MAAM,QAAQ;gBAEd,IAAI,qBAAqB,MAAM,MAAM,CAAC,KAAK;gBAE3C,OAAO,mBAAmB,IAAI;gBAC9B,OAAO,mBAAmB,IAAI;gBAC9B,UAAU,mBAAmB,OAAO;gBACpC,SAAS,mBAAmB,MAAM;gBAClC,KAAK,MAAM,kBAAkB;oBAC3B,IAAI;wBACF,WAAW,MAAM,QAAQ;wBACzB,OAAO;4BACL,OAAO,QAAQ;wBACjB;oBACF,EAAE,OAAO,QAAQ;wBACf,QAAQ;wBACR,OAAO;4BACL,OAAO,OAAO;wBAChB;oBACF;gBACF;gBACA,MAAM,QAAQ;gBAEd,MAAM,SAAS;gBAEf,OAAO;YACT;QACF;IACF;IAEA,SAAS,IAAI,EAAE,GAAG,IAAI,EAAE;QACtB,IAAI,SAAS,QAAQ;QACrB,UAAU,SAAS;QACnB,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,SAAU,QAAQ,EAAE,OAAO;YACpD,UAAU;YACV,OAAO,SAAS;QAClB;QAEA,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;YACf;YACA;YACA;YACA;QACF;QAEA,IAAI,CAAC,SAAS;QAEd,OAAO;IACT;AAEF;AACA,OAAO,OAAO,GAAG","ignoreList":[0]}},
    {"offset": {"line": 2463, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/bottleneck/lib/version.json"],"sourcesContent":["{\"version\":\"2.19.5\"}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 2463, "column": 46}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2467, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/Group.js"],"sourcesContent":["\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Events, Group, IORedisConnection, RedisConnection, Scripts, parser;\nparser = require(\"./parser\");\nEvents = require(\"./Events\");\nRedisConnection = require(\"./RedisConnection\");\nIORedisConnection = require(\"./IORedisConnection\");\nScripts = require(\"./Scripts\");\n\nGroup = function () {\n  class Group {\n    constructor(limiterOptions = {}) {\n      this.deleteKey = this.deleteKey.bind(this);\n      this.limiterOptions = limiterOptions;\n      parser.load(this.limiterOptions, this.defaults, this);\n      this.Events = new Events(this);\n      this.instances = {};\n      this.Bottleneck = require(\"./Bottleneck\");\n\n      this._startAutoCleanup();\n\n      this.sharedConnection = this.connection != null;\n\n      if (this.connection == null) {\n        if (this.limiterOptions.datastore === \"redis\") {\n          this.connection = new RedisConnection(Object.assign({}, this.limiterOptions, {\n            Events: this.Events\n          }));\n        } else if (this.limiterOptions.datastore === \"ioredis\") {\n          this.connection = new IORedisConnection(Object.assign({}, this.limiterOptions, {\n            Events: this.Events\n          }));\n        }\n      }\n    }\n\n    key(key = \"\") {\n      var ref;\n      return (ref = this.instances[key]) != null ? ref : (() => {\n        var limiter;\n        limiter = this.instances[key] = new this.Bottleneck(Object.assign(this.limiterOptions, {\n          id: `${this.id}-${key}`,\n          timeout: this.timeout,\n          connection: this.connection\n        }));\n        this.Events.trigger(\"created\", limiter, key);\n        return limiter;\n      })();\n    }\n\n    deleteKey(key = \"\") {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var deleted, instance;\n        instance = _this.instances[key];\n\n        if (_this.connection) {\n          deleted = yield _this.connection.__runCommand__(['del', ...Scripts.allKeys(`${_this.id}-${key}`)]);\n        }\n\n        if (instance != null) {\n          delete _this.instances[key];\n          yield instance.disconnect();\n        }\n\n        return instance != null || deleted > 0;\n      })();\n    }\n\n    limiters() {\n      var k, ref, results, v;\n      ref = this.instances;\n      results = [];\n\n      for (k in ref) {\n        v = ref[k];\n        results.push({\n          key: k,\n          limiter: v\n        });\n      }\n\n      return results;\n    }\n\n    keys() {\n      return Object.keys(this.instances);\n    }\n\n    clusterKeys() {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        var cursor, end, found, i, k, keys, len, next, start;\n\n        if (_this2.connection == null) {\n          return _this2.Promise.resolve(_this2.keys());\n        }\n\n        keys = [];\n        cursor = null;\n        start = `b_${_this2.id}-`.length;\n        end = \"_settings\".length;\n\n        while (cursor !== 0) {\n          var _ref = yield _this2.connection.__runCommand__([\"scan\", cursor != null ? cursor : 0, \"match\", `b_${_this2.id}-*_settings`, \"count\", 10000]);\n\n          var _ref2 = _slicedToArray(_ref, 2);\n\n          next = _ref2[0];\n          found = _ref2[1];\n          cursor = ~~next;\n\n          for (i = 0, len = found.length; i < len; i++) {\n            k = found[i];\n            keys.push(k.slice(start, -end));\n          }\n        }\n\n        return keys;\n      })();\n    }\n\n    _startAutoCleanup() {\n      var _this3 = this;\n\n      var base;\n      clearInterval(this.interval);\n      return typeof (base = this.interval = setInterval(\n      /*#__PURE__*/\n      _asyncToGenerator(function* () {\n        var e, k, ref, results, time, v;\n        time = Date.now();\n        ref = _this3.instances;\n        results = [];\n\n        for (k in ref) {\n          v = ref[k];\n\n          try {\n            if (yield v._store.__groupCheck__(time)) {\n              results.push(_this3.deleteKey(k));\n            } else {\n              results.push(void 0);\n            }\n          } catch (error) {\n            e = error;\n            results.push(v.Events.trigger(\"error\", e));\n          }\n        }\n\n        return results;\n      }), this.timeout / 2)).unref === \"function\" ? base.unref() : void 0;\n    }\n\n    updateSettings(options = {}) {\n      parser.overwrite(options, this.defaults, this);\n      parser.overwrite(options, options, this.limiterOptions);\n\n      if (options.timeout != null) {\n        return this._startAutoCleanup();\n      }\n    }\n\n    disconnect(flush = true) {\n      var ref;\n\n      if (!this.sharedConnection) {\n        return (ref = this.connection) != null ? ref.disconnect(flush) : void 0;\n      }\n    }\n\n  }\n\n  ;\n  Group.prototype.defaults = {\n    timeout: 1000 * 60 * 5,\n    connection: null,\n    Promise: Promise,\n    id: \"group-key\"\n  };\n  return Group;\n}.call(void 0);\n\nmodule.exports = Group;"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2688, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/Batcher.js"],"sourcesContent":["\"use strict\";\n\nvar Batcher, Events, parser;\nparser = require(\"./parser\");\nEvents = require(\"./Events\");\n\nBatcher = function () {\n  class Batcher {\n    constructor(options = {}) {\n      this.options = options;\n      parser.load(this.options, this.defaults, this);\n      this.Events = new Events(this);\n      this._arr = [];\n\n      this._resetPromise();\n\n      this._lastFlush = Date.now();\n    }\n\n    _resetPromise() {\n      return this._promise = new this.Promise((res, rej) => {\n        return this._resolve = res;\n      });\n    }\n\n    _flush() {\n      clearTimeout(this._timeout);\n      this._lastFlush = Date.now();\n\n      this._resolve();\n\n      this.Events.trigger(\"batch\", this._arr);\n      this._arr = [];\n      return this._resetPromise();\n    }\n\n    add(data) {\n      var ret;\n\n      this._arr.push(data);\n\n      ret = this._promise;\n\n      if (this._arr.length === this.maxSize) {\n        this._flush();\n      } else if (this.maxTime != null && this._arr.length === 1) {\n        this._timeout = setTimeout(() => {\n          return this._flush();\n        }, this.maxTime);\n      }\n\n      return ret;\n    }\n\n  }\n\n  ;\n  Batcher.prototype.defaults = {\n    maxTime: null,\n    maxSize: null,\n    Promise: Promise\n  };\n  return Batcher;\n}.call(void 0);\n\nmodule.exports = Batcher;"],"names":[],"mappings":"AAEA,IAAI,SAAS,QAAQ;AACrB;AACA;AAEA,UAAU,CAAA;IACR,MAAM;QACJ,YAAY,UAAU,CAAC,CAAC,CAAE;YACxB,IAAI,CAAC,OAAO,GAAG;YACf,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI;YAC7C,IAAI,CAAC,MAAM,GAAG,IAAI,OAAO,IAAI;YAC7B,IAAI,CAAC,IAAI,GAAG,EAAE;YAEd,IAAI,CAAC,aAAa;YAElB,IAAI,CAAC,UAAU,GAAG,KAAK,GAAG;QAC5B;QAEA,gBAAgB;YACd,OAAO,IAAI,CAAC,QAAQ,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,KAAK;gBAC5C,OAAO,IAAI,CAAC,QAAQ,GAAG;YACzB;QACF;QAEA,SAAS;YACP,aAAa,IAAI,CAAC,QAAQ;YAC1B,IAAI,CAAC,UAAU,GAAG,KAAK,GAAG;YAE1B,IAAI,CAAC,QAAQ;YAEb,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,IAAI,CAAC,IAAI;YACtC,IAAI,CAAC,IAAI,GAAG,EAAE;YACd,OAAO,IAAI,CAAC,aAAa;QAC3B;QAEA,IAAI,IAAI,EAAE;YACR,IAAI;YAEJ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;YAEf,MAAM,IAAI,CAAC,QAAQ;YAEnB,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,OAAO,EAAE;gBACrC,IAAI,CAAC,MAAM;YACb,OAAO,IAAI,IAAI,CAAC,OAAO,IAAI,QAAQ,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,GAAG;gBACzD,IAAI,CAAC,QAAQ,GAAG,WAAW;oBACzB,OAAO,IAAI,CAAC,MAAM;gBACpB,GAAG,IAAI,CAAC,OAAO;YACjB;YAEA,OAAO;QACT;IAEF;;IAGA,QAAQ,SAAS,CAAC,QAAQ,GAAG;QAC3B,SAAS;QACT,SAAS;QACT,SAAS;IACX;IACA,OAAO;AACT,CAAA,EAAE,IAAI,CAAC,KAAK;AAEZ,OAAO,OAAO,GAAG","ignoreList":[0]}},
    {"offset": {"line": 2741, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/Bottleneck.js"],"sourcesContent":["\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _toArray(arr) { return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nvar Bottleneck,\n    DEFAULT_PRIORITY,\n    Events,\n    Job,\n    LocalDatastore,\n    NUM_PRIORITIES,\n    Queues,\n    RedisDatastore,\n    States,\n    Sync,\n    parser,\n    splice = [].splice;\nNUM_PRIORITIES = 10;\nDEFAULT_PRIORITY = 5;\nparser = require(\"./parser\");\nQueues = require(\"./Queues\");\nJob = require(\"./Job\");\nLocalDatastore = require(\"./LocalDatastore\");\nRedisDatastore = require(\"./RedisDatastore\");\nEvents = require(\"./Events\");\nStates = require(\"./States\");\nSync = require(\"./Sync\");\n\nBottleneck = function () {\n  class Bottleneck {\n    constructor(options = {}, ...invalid) {\n      var storeInstanceOptions, storeOptions;\n      this._addToQueue = this._addToQueue.bind(this);\n\n      this._validateOptions(options, invalid);\n\n      parser.load(options, this.instanceDefaults, this);\n      this._queues = new Queues(NUM_PRIORITIES);\n      this._scheduled = {};\n      this._states = new States([\"RECEIVED\", \"QUEUED\", \"RUNNING\", \"EXECUTING\"].concat(this.trackDoneStatus ? [\"DONE\"] : []));\n      this._limiter = null;\n      this.Events = new Events(this);\n      this._submitLock = new Sync(\"submit\", this.Promise);\n      this._registerLock = new Sync(\"register\", this.Promise);\n      storeOptions = parser.load(options, this.storeDefaults, {});\n\n      this._store = function () {\n        if (this.datastore === \"redis\" || this.datastore === \"ioredis\" || this.connection != null) {\n          storeInstanceOptions = parser.load(options, this.redisStoreDefaults, {});\n          return new RedisDatastore(this, storeOptions, storeInstanceOptions);\n        } else if (this.datastore === \"local\") {\n          storeInstanceOptions = parser.load(options, this.localStoreDefaults, {});\n          return new LocalDatastore(this, storeOptions, storeInstanceOptions);\n        } else {\n          throw new Bottleneck.prototype.BottleneckError(`Invalid datastore type: ${this.datastore}`);\n        }\n      }.call(this);\n\n      this._queues.on(\"leftzero\", () => {\n        var ref;\n        return (ref = this._store.heartbeat) != null ? typeof ref.ref === \"function\" ? ref.ref() : void 0 : void 0;\n      });\n\n      this._queues.on(\"zero\", () => {\n        var ref;\n        return (ref = this._store.heartbeat) != null ? typeof ref.unref === \"function\" ? ref.unref() : void 0 : void 0;\n      });\n    }\n\n    _validateOptions(options, invalid) {\n      if (!(options != null && typeof options === \"object\" && invalid.length === 0)) {\n        throw new Bottleneck.prototype.BottleneckError(\"Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.\");\n      }\n    }\n\n    ready() {\n      return this._store.ready;\n    }\n\n    clients() {\n      return this._store.clients;\n    }\n\n    channel() {\n      return `b_${this.id}`;\n    }\n\n    channel_client() {\n      return `b_${this.id}_${this._store.clientId}`;\n    }\n\n    publish(message) {\n      return this._store.__publish__(message);\n    }\n\n    disconnect(flush = true) {\n      return this._store.__disconnect__(flush);\n    }\n\n    chain(_limiter) {\n      this._limiter = _limiter;\n      return this;\n    }\n\n    queued(priority) {\n      return this._queues.queued(priority);\n    }\n\n    clusterQueued() {\n      return this._store.__queued__();\n    }\n\n    empty() {\n      return this.queued() === 0 && this._submitLock.isEmpty();\n    }\n\n    running() {\n      return this._store.__running__();\n    }\n\n    done() {\n      return this._store.__done__();\n    }\n\n    jobStatus(id) {\n      return this._states.jobStatus(id);\n    }\n\n    jobs(status) {\n      return this._states.statusJobs(status);\n    }\n\n    counts() {\n      return this._states.statusCounts();\n    }\n\n    _randomIndex() {\n      return Math.random().toString(36).slice(2);\n    }\n\n    check(weight = 1) {\n      return this._store.__check__(weight);\n    }\n\n    _clearGlobalState(index) {\n      if (this._scheduled[index] != null) {\n        clearTimeout(this._scheduled[index].expiration);\n        delete this._scheduled[index];\n        return true;\n      } else {\n        return false;\n      }\n    }\n\n    _free(index, job, options, eventInfo) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var e, running;\n\n        try {\n          var _ref = yield _this._store.__free__(index, options.weight);\n\n          running = _ref.running;\n\n          _this.Events.trigger(\"debug\", `Freed ${options.id}`, eventInfo);\n\n          if (running === 0 && _this.empty()) {\n            return _this.Events.trigger(\"idle\");\n          }\n        } catch (error1) {\n          e = error1;\n          return _this.Events.trigger(\"error\", e);\n        }\n      })();\n    }\n\n    _run(index, job, wait) {\n      var clearGlobalState, free, run;\n      job.doRun();\n      clearGlobalState = this._clearGlobalState.bind(this, index);\n      run = this._run.bind(this, index, job);\n      free = this._free.bind(this, index, job);\n      return this._scheduled[index] = {\n        timeout: setTimeout(() => {\n          return job.doExecute(this._limiter, clearGlobalState, run, free);\n        }, wait),\n        expiration: job.options.expiration != null ? setTimeout(function () {\n          return job.doExpire(clearGlobalState, run, free);\n        }, wait + job.options.expiration) : void 0,\n        job: job\n      };\n    }\n\n    _drainOne(capacity) {\n      return this._registerLock.schedule(() => {\n        var args, index, next, options, queue;\n\n        if (this.queued() === 0) {\n          return this.Promise.resolve(null);\n        }\n\n        queue = this._queues.getFirst();\n\n        var _next2 = next = queue.first();\n\n        options = _next2.options;\n        args = _next2.args;\n\n        if (capacity != null && options.weight > capacity) {\n          return this.Promise.resolve(null);\n        }\n\n        this.Events.trigger(\"debug\", `Draining ${options.id}`, {\n          args,\n          options\n        });\n        index = this._randomIndex();\n        return this._store.__register__(index, options.weight, options.expiration).then(({\n          success,\n          wait,\n          reservoir\n        }) => {\n          var empty;\n          this.Events.trigger(\"debug\", `Drained ${options.id}`, {\n            success,\n            args,\n            options\n          });\n\n          if (success) {\n            queue.shift();\n            empty = this.empty();\n\n            if (empty) {\n              this.Events.trigger(\"empty\");\n            }\n\n            if (reservoir === 0) {\n              this.Events.trigger(\"depleted\", empty);\n            }\n\n            this._run(index, next, wait);\n\n            return this.Promise.resolve(options.weight);\n          } else {\n            return this.Promise.resolve(null);\n          }\n        });\n      });\n    }\n\n    _drainAll(capacity, total = 0) {\n      return this._drainOne(capacity).then(drained => {\n        var newCapacity;\n\n        if (drained != null) {\n          newCapacity = capacity != null ? capacity - drained : capacity;\n          return this._drainAll(newCapacity, total + drained);\n        } else {\n          return this.Promise.resolve(total);\n        }\n      }).catch(e => {\n        return this.Events.trigger(\"error\", e);\n      });\n    }\n\n    _dropAllQueued(message) {\n      return this._queues.shiftAll(function (job) {\n        return job.doDrop({\n          message\n        });\n      });\n    }\n\n    stop(options = {}) {\n      var done, waitForExecuting;\n      options = parser.load(options, this.stopDefaults);\n\n      waitForExecuting = at => {\n        var finished;\n\n        finished = () => {\n          var counts;\n          counts = this._states.counts;\n          return counts[0] + counts[1] + counts[2] + counts[3] === at;\n        };\n\n        return new this.Promise((resolve, reject) => {\n          if (finished()) {\n            return resolve();\n          } else {\n            return this.on(\"done\", () => {\n              if (finished()) {\n                this.removeAllListeners(\"done\");\n                return resolve();\n              }\n            });\n          }\n        });\n      };\n\n      done = options.dropWaitingJobs ? (this._run = function (index, next) {\n        return next.doDrop({\n          message: options.dropErrorMessage\n        });\n      }, this._drainOne = () => {\n        return this.Promise.resolve(null);\n      }, this._registerLock.schedule(() => {\n        return this._submitLock.schedule(() => {\n          var k, ref, v;\n          ref = this._scheduled;\n\n          for (k in ref) {\n            v = ref[k];\n\n            if (this.jobStatus(v.job.options.id) === \"RUNNING\") {\n              clearTimeout(v.timeout);\n              clearTimeout(v.expiration);\n              v.job.doDrop({\n                message: options.dropErrorMessage\n              });\n            }\n          }\n\n          this._dropAllQueued(options.dropErrorMessage);\n\n          return waitForExecuting(0);\n        });\n      })) : this.schedule({\n        priority: NUM_PRIORITIES - 1,\n        weight: 0\n      }, () => {\n        return waitForExecuting(1);\n      });\n\n      this._receive = function (job) {\n        return job._reject(new Bottleneck.prototype.BottleneckError(options.enqueueErrorMessage));\n      };\n\n      this.stop = () => {\n        return this.Promise.reject(new Bottleneck.prototype.BottleneckError(\"stop() has already been called\"));\n      };\n\n      return done;\n    }\n\n    _addToQueue(job) {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        var args, blocked, error, options, reachedHWM, shifted, strategy;\n        args = job.args;\n        options = job.options;\n\n        try {\n          var _ref2 = yield _this2._store.__submit__(_this2.queued(), options.weight);\n\n          reachedHWM = _ref2.reachedHWM;\n          blocked = _ref2.blocked;\n          strategy = _ref2.strategy;\n        } catch (error1) {\n          error = error1;\n\n          _this2.Events.trigger(\"debug\", `Could not queue ${options.id}`, {\n            args,\n            options,\n            error\n          });\n\n          job.doDrop({\n            error\n          });\n          return false;\n        }\n\n        if (blocked) {\n          job.doDrop();\n          return true;\n        } else if (reachedHWM) {\n          shifted = strategy === Bottleneck.prototype.strategy.LEAK ? _this2._queues.shiftLastFrom(options.priority) : strategy === Bottleneck.prototype.strategy.OVERFLOW_PRIORITY ? _this2._queues.shiftLastFrom(options.priority + 1) : strategy === Bottleneck.prototype.strategy.OVERFLOW ? job : void 0;\n\n          if (shifted != null) {\n            shifted.doDrop();\n          }\n\n          if (shifted == null || strategy === Bottleneck.prototype.strategy.OVERFLOW) {\n            if (shifted == null) {\n              job.doDrop();\n            }\n\n            return reachedHWM;\n          }\n        }\n\n        job.doQueue(reachedHWM, blocked);\n\n        _this2._queues.push(job);\n\n        yield _this2._drainAll();\n        return reachedHWM;\n      })();\n    }\n\n    _receive(job) {\n      if (this._states.jobStatus(job.options.id) != null) {\n        job._reject(new Bottleneck.prototype.BottleneckError(`A job with the same id already exists (id=${job.options.id})`));\n\n        return false;\n      } else {\n        job.doReceive();\n        return this._submitLock.schedule(this._addToQueue, job);\n      }\n    }\n\n    submit(...args) {\n      var cb, fn, job, options, ref, ref1, task;\n\n      if (typeof args[0] === \"function\") {\n        var _ref3, _ref4, _splice$call, _splice$call2;\n\n        ref = args, (_ref3 = ref, _ref4 = _toArray(_ref3), fn = _ref4[0], args = _ref4.slice(1), _ref3), (_splice$call = splice.call(args, -1), _splice$call2 = _slicedToArray(_splice$call, 1), cb = _splice$call2[0], _splice$call);\n        options = parser.load({}, this.jobDefaults);\n      } else {\n        var _ref5, _ref6, _splice$call3, _splice$call4;\n\n        ref1 = args, (_ref5 = ref1, _ref6 = _toArray(_ref5), options = _ref6[0], fn = _ref6[1], args = _ref6.slice(2), _ref5), (_splice$call3 = splice.call(args, -1), _splice$call4 = _slicedToArray(_splice$call3, 1), cb = _splice$call4[0], _splice$call3);\n        options = parser.load(options, this.jobDefaults);\n      }\n\n      task = (...args) => {\n        return new this.Promise(function (resolve, reject) {\n          return fn(...args, function (...args) {\n            return (args[0] != null ? reject : resolve)(args);\n          });\n        });\n      };\n\n      job = new Job(task, args, options, this.jobDefaults, this.rejectOnDrop, this.Events, this._states, this.Promise);\n      job.promise.then(function (args) {\n        return typeof cb === \"function\" ? cb(...args) : void 0;\n      }).catch(function (args) {\n        if (Array.isArray(args)) {\n          return typeof cb === \"function\" ? cb(...args) : void 0;\n        } else {\n          return typeof cb === \"function\" ? cb(args) : void 0;\n        }\n      });\n      return this._receive(job);\n    }\n\n    schedule(...args) {\n      var job, options, task;\n\n      if (typeof args[0] === \"function\") {\n        var _args = args;\n\n        var _args2 = _toArray(_args);\n\n        task = _args2[0];\n        args = _args2.slice(1);\n        options = {};\n      } else {\n        var _args3 = args;\n\n        var _args4 = _toArray(_args3);\n\n        options = _args4[0];\n        task = _args4[1];\n        args = _args4.slice(2);\n      }\n\n      job = new Job(task, args, options, this.jobDefaults, this.rejectOnDrop, this.Events, this._states, this.Promise);\n\n      this._receive(job);\n\n      return job.promise;\n    }\n\n    wrap(fn) {\n      var schedule, wrapped;\n      schedule = this.schedule.bind(this);\n\n      wrapped = function wrapped(...args) {\n        return schedule(fn.bind(this), ...args);\n      };\n\n      wrapped.withOptions = function (options, ...args) {\n        return schedule(options, fn, ...args);\n      };\n\n      return wrapped;\n    }\n\n    updateSettings(options = {}) {\n      var _this3 = this;\n\n      return _asyncToGenerator(function* () {\n        yield _this3._store.__updateSettings__(parser.overwrite(options, _this3.storeDefaults));\n        parser.overwrite(options, _this3.instanceDefaults, _this3);\n        return _this3;\n      })();\n    }\n\n    currentReservoir() {\n      return this._store.__currentReservoir__();\n    }\n\n    incrementReservoir(incr = 0) {\n      return this._store.__incrementReservoir__(incr);\n    }\n\n  }\n\n  ;\n  Bottleneck.default = Bottleneck;\n  Bottleneck.Events = Events;\n  Bottleneck.version = Bottleneck.prototype.version = require(\"./version.json\").version;\n  Bottleneck.strategy = Bottleneck.prototype.strategy = {\n    LEAK: 1,\n    OVERFLOW: 2,\n    OVERFLOW_PRIORITY: 4,\n    BLOCK: 3\n  };\n  Bottleneck.BottleneckError = Bottleneck.prototype.BottleneckError = require(\"./BottleneckError\");\n  Bottleneck.Group = Bottleneck.prototype.Group = require(\"./Group\");\n  Bottleneck.RedisConnection = Bottleneck.prototype.RedisConnection = require(\"./RedisConnection\");\n  Bottleneck.IORedisConnection = Bottleneck.prototype.IORedisConnection = require(\"./IORedisConnection\");\n  Bottleneck.Batcher = Bottleneck.prototype.Batcher = require(\"./Batcher\");\n  Bottleneck.prototype.jobDefaults = {\n    priority: DEFAULT_PRIORITY,\n    weight: 1,\n    expiration: null,\n    id: \"<no-id>\"\n  };\n  Bottleneck.prototype.storeDefaults = {\n    maxConcurrent: null,\n    minTime: 0,\n    highWater: null,\n    strategy: Bottleneck.prototype.strategy.LEAK,\n    penalty: null,\n    reservoir: null,\n    reservoirRefreshInterval: null,\n    reservoirRefreshAmount: null,\n    reservoirIncreaseInterval: null,\n    reservoirIncreaseAmount: null,\n    reservoirIncreaseMaximum: null\n  };\n  Bottleneck.prototype.localStoreDefaults = {\n    Promise: Promise,\n    timeout: null,\n    heartbeatInterval: 250\n  };\n  Bottleneck.prototype.redisStoreDefaults = {\n    Promise: Promise,\n    timeout: null,\n    heartbeatInterval: 5000,\n    clientTimeout: 10000,\n    Redis: null,\n    clientOptions: {},\n    clusterNodes: null,\n    clearDatastore: false,\n    connection: null\n  };\n  Bottleneck.prototype.instanceDefaults = {\n    datastore: \"local\",\n    connection: null,\n    id: \"<no-id>\",\n    rejectOnDrop: true,\n    trackDoneStatus: false,\n    Promise: Promise\n  };\n  Bottleneck.prototype.stopDefaults = {\n    enqueueErrorMessage: \"This limiter has been stopped and cannot accept new jobs.\",\n    dropWaitingJobs: true,\n    dropErrorMessage: \"This limiter has been stopped.\"\n  };\n  return Bottleneck;\n}.call(void 0);\n\nmodule.exports = Bottleneck;"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 3279, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/node_modules/bottleneck/lib/index.js"],"sourcesContent":["\"use strict\";\n\nmodule.exports = require(\"./Bottleneck\");"],"names":[],"mappings":"AAEA,OAAO,OAAO","ignoreList":[0]}}]
}