{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/lib/supabase/client.ts"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr'\r\n\r\nexport function createClient() {\r\n  return createBrowserClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n  )\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,iMAAmB;AAI5B"}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/app/dashboard/layout.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\nimport { usePathname, useRouter } from 'next/navigation';\r\nimport { BarChart3, MessageSquare, Settings, RefreshCw, LogOut, ChevronDown, Play } from 'lucide-react';\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport type { User as SupabaseUser } from '@supabase/supabase-js';\r\n\r\nconst navItems = [\r\n  { href: '/dashboard', icon: BarChart3, label: 'Overview' },\r\n  { href: '/dashboard/chat', icon: MessageSquare, label: 'AI Chat' },\r\n  { href: '/dashboard/settings', icon: Settings, label: 'Settings' },\r\n];\r\n\r\nexport default function DashboardLayout({\r\n  children,\r\n}: {\r\n  children: React.ReactNode;\r\n}) {\r\n  const pathname = usePathname();\r\n  const router = useRouter();\r\n  const [syncing, setSyncing] = useState(false);\r\n  const [user, setUser] = useState<SupabaseUser | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showUserMenu, setShowUserMenu] = useState(false);\r\n  const [isDemoMode, setIsDemoMode] = useState(false);\r\n  const userMenuRef = useRef<HTMLDivElement>(null);\r\n  const supabase = createClient();\r\n\r\n  // Always check auth first, then determine if demo mode applies\r\n  useEffect(() => {\r\n    const checkAuthAndDemoMode = async () => {\r\n      // Check for demo mode in URL params\r\n      const urlParams = new URLSearchParams(window.location.search);\r\n      const demoFromUrl = urlParams.get('demo') === 'true';\r\n      \r\n      if (demoFromUrl) {\r\n        // Clean the URL\r\n        window.history.replaceState({}, '', window.location.pathname);\r\n      }\r\n      \r\n      // Always check auth first\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      setUser(user);\r\n      \r\n      // If user is logged in, ALWAYS clear demo mode\r\n      if (user) {\r\n        localStorage.removeItem('demo_mode');\r\n        setIsDemoMode(false);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      \r\n      // User is NOT logged in - check if demo mode is requested\r\n      const demoMode = localStorage.getItem('demo_mode') === 'true' || demoFromUrl;\r\n      \r\n      if (demoMode) {\r\n        // Set demo mode for unauthenticated users\r\n        localStorage.setItem('demo_mode', 'true');\r\n        setIsDemoMode(true);\r\n        setLoading(false);\r\n      } else {\r\n        // Not logged in and not in demo mode - redirect to login\r\n        router.push('/login');\r\n      }\r\n    };\r\n    \r\n    checkAuthAndDemoMode();\r\n\r\n    // Listen for auth changes\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((event, session) => {\r\n      setUser(session?.user ?? null);\r\n      \r\n      // If user logs in, clear demo mode\r\n      if (session?.user) {\r\n        localStorage.removeItem('demo_mode');\r\n        setIsDemoMode(false);\r\n      } else if (!localStorage.getItem('demo_mode')) {\r\n        // User logged out and not in demo mode\r\n        router.push('/login');\r\n      }\r\n    });\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, [supabase, router]);\r\n\r\n  // Close user menu when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (userMenuRef.current && !userMenuRef.current.contains(event.target as Node)) {\r\n        setShowUserMenu(false);\r\n      }\r\n    };\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  const handleSync = async () => {\r\n    if (isDemoMode) return; // Don't sync in demo mode\r\n    \r\n    setSyncing(true);\r\n    try {\r\n      await fetch('/api/sync-data', { method: 'POST' });\r\n    } catch (error) {\r\n      console.error('Sync error:', error);\r\n    }\r\n    setSyncing(false);\r\n  };\r\n\r\n  const handleSignOut = async () => {\r\n    // Clear demo mode when signing out\r\n    localStorage.removeItem('demo_mode');\r\n    await supabase.auth.signOut();\r\n    router.push('/login');\r\n  };\r\n\r\n  const handleExitDemo = () => {\r\n    localStorage.removeItem('demo_mode');\r\n    router.push('/login');\r\n  };\r\n\r\n  const userInitial = user?.email?.charAt(0).toUpperCase() || 'D';\r\n  const displayEmail = user?.email || 'Demo User';\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen gradient-bg flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-purple-500\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen gradient-bg flex\">\r\n      {/* Sidebar */}\r\n      <aside className=\"w-64 border-r border-white/10 p-6 flex flex-col\">\r\n        {/* Logo */}\r\n        <Link href=\"/dashboard\" className=\"flex items-center gap-3 mb-8\">\r\n          <Image\r\n            src=\"/logo.png\"\r\n            alt=\"Marketing Analytics\"\r\n            width={40}\r\n            height={40}\r\n            className=\"rounded-lg\"\r\n          />\r\n          <span className=\"text-xl font-semibold text-blue-400\">Marketing Analytics</span>\r\n        </Link>\r\n\r\n        {/* Demo Mode Badge */}\r\n        {isDemoMode && (\r\n          <div className=\"mb-4 px-3 py-2 rounded-lg bg-emerald-500/10 border border-emerald-500/30\">\r\n            <div className=\"flex items-center gap-2 text-emerald-400 text-sm font-medium\">\r\n              <Play className=\"w-4 h-4\" />\r\n              Demo Mode\r\n            </div>\r\n            <p className=\"text-xs text-gray-400 mt-1\">Viewing sample data</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Navigation */}\r\n        <nav className=\"flex-1 space-y-2\">\r\n          {navItems.map((item) => {\r\n            const isActive = pathname === item.href;\r\n            return (\r\n              <Link\r\n                key={item.href}\r\n                href={item.href}\r\n                className={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${\r\n                  isActive\r\n                    ? 'bg-purple-500/20 text-purple-300 border border-purple-500/30'\r\n                    : 'text-gray-400 hover:bg-white/5 hover:text-white'\r\n                }`}\r\n              >\r\n                <item.icon className=\"w-5 h-5\" />\r\n                {item.label}\r\n              </Link>\r\n            );\r\n          })}\r\n        </nav>\r\n\r\n        {/* Sync Button - Only show when logged in */}\r\n        {!isDemoMode && (\r\n          <button\r\n            onClick={handleSync}\r\n            disabled={syncing}\r\n            className=\"flex items-center justify-center gap-2 px-4 py-3 rounded-xl bg-white/10 hover:bg-white/20 transition-colors text-sm disabled:opacity-50\"\r\n          >\r\n            <RefreshCw className={`w-4 h-4 ${syncing ? 'animate-spin' : ''}`} />\r\n            {syncing ? 'Syncing...' : 'Sync Data'}\r\n          </button>\r\n        )}\r\n\r\n        {/* User Profile / Demo Controls */}\r\n        <div className=\"mt-6 relative\" ref={userMenuRef}>\r\n          {isDemoMode ? (\r\n            <button\r\n              onClick={handleExitDemo}\r\n              className=\"w-full p-4 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-colors flex items-center gap-3\"\r\n            >\r\n              <div className=\"w-10 h-10 rounded-full bg-emerald-500/30 border border-emerald-500/50 flex items-center justify-center\">\r\n                <Play className=\"w-5 h-5 text-emerald-300\" />\r\n              </div>\r\n              <div className=\"flex-1 text-left\">\r\n                <p className=\"text-sm font-medium\">Demo Mode</p>\r\n                <p className=\"text-xs text-gray-500\">Click to exit</p>\r\n              </div>\r\n            </button>\r\n          ) : (\r\n            <>\r\n              <button\r\n                onClick={() => setShowUserMenu(!showUserMenu)}\r\n                className=\"w-full p-4 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-colors flex items-center gap-3\"\r\n              >\r\n                <div className=\"w-10 h-10 rounded-full bg-purple-500/30 border border-purple-500/50 flex items-center justify-center\">\r\n                  <span className=\"text-purple-300 font-semibold\">{userInitial}</span>\r\n                </div>\r\n                <div className=\"flex-1 text-left\">\r\n                  <p className=\"text-sm font-medium truncate\">{displayEmail}</p>\r\n                  <p className=\"text-xs text-gray-500\">Logged in</p>\r\n                </div>\r\n                <ChevronDown className={`w-4 h-4 text-gray-500 transition-transform ${showUserMenu ? 'rotate-180' : ''}`} />\r\n              </button>\r\n\r\n              {/* User Dropdown Menu */}\r\n              {showUserMenu && (\r\n                <div className=\"absolute bottom-full left-0 right-0 mb-2 bg-gray-900 border border-white/10 rounded-xl shadow-2xl overflow-hidden z-50\">\r\n                  <div className=\"p-3 border-b border-white/10\">\r\n                    <p className=\"text-sm font-medium\">{displayEmail}</p>\r\n                    <p className=\"text-xs text-gray-500\">Account</p>\r\n                  </div>\r\n                  <Link\r\n                    href=\"/dashboard/settings\"\r\n                    className=\"flex items-center gap-3 px-4 py-3 hover:bg-white/5 transition-colors\"\r\n                    onClick={() => setShowUserMenu(false)}\r\n                  >\r\n                    <Settings className=\"w-4 h-4 text-gray-400\" />\r\n                    <span className=\"text-sm\">Settings</span>\r\n                  </Link>\r\n                  <button\r\n                    onClick={handleSignOut}\r\n                    className=\"w-full flex items-center gap-3 px-4 py-3 hover:bg-white/5 transition-colors text-red-400\"\r\n                  >\r\n                    <LogOut className=\"w-4 h-4\" />\r\n                    <span className=\"text-sm\">Sign Out</span>\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n      </aside>\r\n\r\n      {/* Main Content */}\r\n      <main className=\"flex-1 overflow-auto p-6\">\r\n        {children}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}