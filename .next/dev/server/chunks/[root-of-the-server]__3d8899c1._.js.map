{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\r\nimport { cookies } from 'next/headers'\r\n\r\nexport async function createClient() {\r\n  const cookieStore = await cookies()\r\n\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        getAll() {\r\n          return cookieStore.getAll()\r\n        },\r\n        setAll(cookiesToSet) {\r\n          try {\r\n            cookiesToSet.forEach(({ name, value, options }) =>\r\n              cookieStore.set(name, value, options)\r\n            )\r\n          } catch {\r\n            // The `setAll` method was called from a Server Component.\r\n            // This can be ignored if you have middleware refreshing\r\n            // user sessions.\r\n          }\r\n        },\r\n      },\r\n    }\r\n  )\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///C:/Code/Mike%20Strickler/ADs%20Chatbot/ai-gateway-experiment/app/api/chat/route.ts"],"sourcesContent":["import { generateText } from 'ai';\r\nimport { createGateway } from '@ai-sdk/gateway';\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\n// Initialize Vercel AI Gateway\r\nconst gateway = createGateway({\r\n  apiKey: process.env.AI_GATEWAY_API_KEY,\r\n});\r\n\r\n// Model ID mapping - convert UI display IDs to actual Vercel AI Gateway model IDs\r\n// See: https://vercel.com/docs/ai-gateway/models-and-providers\r\nconst MODEL_MAP: Record<string, string> = {\r\n  // Anthropic models - use actual Claude 4 models\r\n  'anthropic/claude-sonnet-4-5': 'anthropic/claude-sonnet-4',\r\n  'anthropic/claude-opus-4-5': 'anthropic/claude-opus-4',\r\n  'anthropic/claude-haiku-4-5': 'anthropic/claude-haiku-4',\r\n  // OpenAI models - map fictional GPT-5 to available GPT-4o models\r\n  'openai/gpt-5': 'openai/gpt-4o',\r\n  'openai/gpt-5-mini': 'openai/gpt-4o-mini',\r\n  'openai/gpt-5-nano': 'openai/gpt-4o-mini',\r\n  'openai/gpt-5-pro': 'openai/o1',\r\n  'openai/gpt-5-codex': 'openai/gpt-4o',\r\n  'openai/gpt-5.1': 'openai/gpt-4.1',\r\n  'openai/gpt-5.1-chat-latest': 'openai/gpt-4.1',\r\n  'openai/gpt-5.1-codex': 'openai/gpt-4.1',\r\n  'openai/gpt-5.1-codex-mini': 'openai/gpt-4.1-mini',\r\n  'openai/gpt-5.1-codex-max': 'openai/gpt-4.1',\r\n  // Google models - use Gemini 2.0 models\r\n  'google/gemini-3': 'google/gemini-2.0-flash',\r\n  'google/gemini-3-pro': 'google/gemini-2.0-flash',\r\n  'google/gemini-3-flash': 'google/gemini-2.0-flash',\r\n};\r\n\r\nexport const maxDuration = 60;\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { messages, model = 'anthropic/claude-sonnet-4-5' } = await request.json();\r\n\r\n    // Check for API key\r\n    if (!process.env.AI_GATEWAY_API_KEY) {\r\n      return NextResponse.json(\r\n        { error: 'AI Gateway API key not configured. Please add AI_GATEWAY_API_KEY to environment variables.' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // Map UI model ID to gateway model ID\r\n    const gatewayModelId = MODEL_MAP[model] || 'anthropic/claude-sonnet-4';\r\n\r\n    // Create authenticated Supabase client\r\n    const supabase = await createClient();\r\n    \r\n    // Get current user\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    \r\n    let tenantId: string | null = null;\r\n    let customInstructions: string | null = null;\r\n    \r\n    if (user) {\r\n      // Get user's tenant and custom instructions\r\n      const { data: profile } = await supabase\r\n        .from('profiles')\r\n        .select('tenant_id, custom_ai_instructions')\r\n        .eq('id', user.id)\r\n        .single();\r\n      \r\n      tenantId = profile?.tenant_id || null;\r\n      customInstructions = profile?.custom_ai_instructions || null;\r\n    }\r\n\r\n    // Fetch connected ad accounts for this tenant\r\n    let adAccounts: any[] = [];\r\n    let campaigns: any[] = [];\r\n    let recentMetrics: any[] = [];\r\n    let customerMetrics: any[] = [];\r\n\r\n    if (tenantId) {\r\n      const { data: accounts } = await supabase\r\n        .from('ad_accounts')\r\n        .select('platform, account_name, status')\r\n        .eq('tenant_id', tenantId)\r\n        .eq('status', 'active');\r\n      adAccounts = accounts || [];\r\n\r\n      // Fetch campaign data for this tenant including customer info\r\n      const { data: campaignData } = await supabase\r\n        .from('campaigns')\r\n        .select('id, campaign_id, campaign_name, platform, status, budget_amount, customer_id, customer_name')\r\n        .eq('tenant_id', tenantId)\r\n        .limit(200);\r\n      campaigns = campaignData || [];\r\n\r\n      // Fetch recent metrics for this tenant (last 30 days to match dashboard)\r\n      const thirtyDaysAgo = new Date();\r\n      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\r\n      const startDate = thirtyDaysAgo.toISOString().split('T')[0];\r\n      \r\n      const { data: metricsData } = await supabase\r\n        .from('campaign_metrics')\r\n        .select('date, impressions, clicks, conversions, spend, revenue, campaign_id')\r\n        .eq('tenant_id', tenantId)\r\n        .gte('date', startDate)\r\n        .order('date', { ascending: false });\r\n      recentMetrics = metricsData || [];\r\n\r\n      // Calculate customer-level metrics\r\n      const campaignToCustomer = new Map<string, { id: string; name: string }>();\r\n      for (const campaign of campaigns) {\r\n        if (campaign.customer_id) {\r\n          campaignToCustomer.set(campaign.id, { \r\n            id: campaign.customer_id, \r\n            name: campaign.customer_name || campaign.customer_id \r\n          });\r\n        }\r\n      }\r\n\r\n      const customerAggregates = new Map<string, {\r\n        name: string;\r\n        spend: number;\r\n        revenue: number;\r\n        conversions: number;\r\n        clicks: number;\r\n        impressions: number;\r\n      }>();\r\n\r\n      for (const metric of recentMetrics) {\r\n        const customer = campaignToCustomer.get(metric.campaign_id);\r\n        if (customer) {\r\n          const existing = customerAggregates.get(customer.id) || {\r\n            name: customer.name,\r\n            spend: 0, revenue: 0, conversions: 0, clicks: 0, impressions: 0\r\n          };\r\n          existing.spend += Number(metric.spend) || 0;\r\n          existing.revenue += Number(metric.revenue) || 0;\r\n          existing.conversions += Number(metric.conversions) || 0;\r\n          existing.clicks += metric.clicks || 0;\r\n          existing.impressions += metric.impressions || 0;\r\n          customerAggregates.set(customer.id, existing);\r\n        }\r\n      }\r\n\r\n      customerMetrics = Array.from(customerAggregates.entries()).map(([id, data]) => ({\r\n        id,\r\n        name: data.name,\r\n        spend: data.spend,\r\n        revenue: data.revenue,\r\n        conversions: data.conversions,\r\n        clicks: data.clicks,\r\n        impressions: data.impressions,\r\n        roas: data.spend > 0 ? data.revenue / data.spend : 0,\r\n        ctr: data.impressions > 0 ? (data.clicks / data.impressions) * 100 : 0,\r\n        cpc: data.clicks > 0 ? data.spend / data.clicks : 0,\r\n        convRate: data.clicks > 0 ? (data.conversions / data.clicks) * 100 : 0,\r\n      })).sort((a, b) => b.spend - a.spend);\r\n    }\r\n\r\n    // Calculate campaign-level performance metrics\r\n    const campaignMetricsMap = new Map<string, {\r\n      spend: number; revenue: number; conversions: number; clicks: number; impressions: number;\r\n    }>();\r\n    for (const metric of recentMetrics) {\r\n      const existing = campaignMetricsMap.get(metric.campaign_id) || {\r\n        spend: 0, revenue: 0, conversions: 0, clicks: 0, impressions: 0\r\n      };\r\n      existing.spend += Number(metric.spend) || 0;\r\n      existing.revenue += Number(metric.revenue) || 0;\r\n      existing.conversions += Number(metric.conversions) || 0;\r\n      existing.clicks += metric.clicks || 0;\r\n      existing.impressions += metric.impressions || 0;\r\n      campaignMetricsMap.set(metric.campaign_id, existing);\r\n    }\r\n\r\n    const campaignPerformance = campaigns.map(c => {\r\n      const metrics = campaignMetricsMap.get(c.id) || { spend: 0, revenue: 0, conversions: 0, clicks: 0, impressions: 0 };\r\n      return {\r\n        name: c.campaign_name,\r\n        customer: c.customer_name || 'Unknown',\r\n        platform: c.platform,\r\n        status: c.status,\r\n        spend: metrics.spend,\r\n        revenue: metrics.revenue,\r\n        roas: metrics.spend > 0 ? metrics.revenue / metrics.spend : 0,\r\n        conversions: metrics.conversions,\r\n        clicks: metrics.clicks,\r\n        impressions: metrics.impressions,\r\n        ctr: metrics.impressions > 0 ? (metrics.clicks / metrics.impressions) * 100 : 0,\r\n        cpc: metrics.clicks > 0 ? metrics.spend / metrics.clicks : 0,\r\n      };\r\n    }).sort((a, b) => b.spend - a.spend);\r\n\r\n    console.log(`Chat API: User ${user?.id}, Tenant ${tenantId}, Accounts: ${adAccounts.length}, Campaigns: ${campaigns.length}, Metrics: ${recentMetrics.length}, Customers: ${customerMetrics.length}`);\r\n\r\n    // Build campaign platform map\r\n    const campaignPlatformMap = new Map<string, string>();\r\n    for (const campaign of campaigns) {\r\n      campaignPlatformMap.set(campaign.id, campaign.platform);\r\n    }\r\n\r\n    // Calculate summary stats\r\n    const totalSpend = recentMetrics.reduce((sum, m) => sum + (Number(m.spend) || 0), 0);\r\n    const totalRevenue = recentMetrics.reduce((sum, m) => sum + (Number(m.revenue) || 0), 0);\r\n    const totalConversions = recentMetrics.reduce((sum, m) => sum + (Number(m.conversions) || 0), 0);\r\n    const totalImpressions = recentMetrics.reduce((sum, m) => sum + (m.impressions || 0), 0);\r\n    const totalClicks = recentMetrics.reduce((sum, m) => sum + (m.clicks || 0), 0);\r\n    const avgROAS = totalSpend > 0 ? totalRevenue / totalSpend : 0;\r\n\r\n    // Calculate insights (after summary stats are calculated)\r\n    const avgCPC = totalClicks > 0 ? totalSpend / totalClicks : 0;\r\n    const conversionRate = totalClicks > 0 ? (totalConversions / totalClicks) * 100 : 0;\r\n    const costPerConversion = totalConversions > 0 ? totalSpend / totalConversions : 0;\r\n\r\n    // Calculate platform-specific stats\r\n    const platformStats: Record<string, any> = {};\r\n    for (const metric of recentMetrics) {\r\n      const platform = campaignPlatformMap.get(metric.campaign_id) || 'google_ads';\r\n      if (!platformStats[platform]) {\r\n        platformStats[platform] = {\r\n          spend: 0, revenue: 0, conversions: 0, impressions: 0, clicks: 0,\r\n        };\r\n      }\r\n      platformStats[platform].spend += Number(metric.spend) || 0;\r\n      platformStats[platform].revenue += Number(metric.revenue) || 0;\r\n      platformStats[platform].conversions += Number(metric.conversions) || 0;\r\n      platformStats[platform].impressions += metric.impressions || 0;\r\n      platformStats[platform].clicks += metric.clicks || 0;\r\n    }\r\n\r\n    const platformBreakdown = Object.entries(platformStats).map(([platform, stats]: [string, any]) => ({\r\n      platform: platform.replace('_ads', '').toUpperCase(),\r\n      spend: stats.spend.toFixed(2),\r\n      revenue: stats.revenue.toFixed(2),\r\n      conversions: stats.conversions.toFixed(1),\r\n      impressions: stats.impressions,\r\n      clicks: stats.clicks,\r\n      roas: stats.spend > 0 ? (stats.revenue / stats.spend).toFixed(2) : '0',\r\n      ctr: stats.impressions > 0 ? ((stats.clicks / stats.impressions) * 100).toFixed(2) : '0',\r\n    }));\r\n\r\n    const hasData = campaigns.length > 0 || recentMetrics.length > 0;\r\n    const hasConnectedAccounts = adAccounts.length > 0;\r\n\r\n    // Build system prompt\r\n    const systemPrompt = `You are an AI marketing analytics assistant helping analyze advertising campaign performance across Google Ads, Meta Ads, and LinkedIn Ads.\r\n\r\nConnected Ad Platforms: ${adAccounts.map((a) => a.platform.replace('_ads', '').toUpperCase()).join(', ') || 'None'}\r\n\r\n${hasData ? `\r\nOVERALL CAMPAIGN SUMMARY:\r\n- Total Active Campaigns: ${campaigns.length}\r\n- Total Ad Spend (last 30 days): $${totalSpend.toFixed(2)}\r\n- Total Revenue: $${totalRevenue.toFixed(2)}\r\n- Total Conversions: ${totalConversions.toFixed(1)}\r\n- Total Impressions: ${totalImpressions.toLocaleString()}\r\n- Total Clicks: ${totalClicks.toLocaleString()}\r\n- Average ROAS: ${avgROAS.toFixed(2)}x\r\n- Overall CTR: ${totalImpressions > 0 ? ((totalClicks / totalImpressions) * 100).toFixed(2) : 0}%\r\n\r\nPLATFORM-SPECIFIC BREAKDOWN:\r\n${platformBreakdown.length > 0 ? JSON.stringify(platformBreakdown, null, 2) : 'No platform-specific data available'}\r\n\r\nTOP CAMPAIGNS (by budget):\r\n${JSON.stringify(\r\n  campaigns\r\n    .sort((a, b) => (b.budget_amount || 0) - (a.budget_amount || 0))\r\n    .slice(0, 10)\r\n    .map((c: any) => ({\r\n      name: c.campaign_name,\r\n      platform: c.platform.replace('_ads', '').toUpperCase(),\r\n      status: c.status,\r\n      budget: c.budget_amount,\r\n    })),\r\n  null,\r\n  2\r\n)}\r\n\r\nDETAILED CAMPAIGN PERFORMANCE (top 20 by spend):\r\n${campaignPerformance.slice(0, 20).map((c, i) => \r\n  `${i + 1}. ${c.name} (${c.customer}): $${c.spend.toFixed(2)} spend, $${c.revenue.toFixed(2)} revenue, ${c.roas.toFixed(2)}x ROAS, ${c.conversions.toFixed(0)} conversions, ${c.ctr.toFixed(2)}% CTR`\r\n).join('\\n')}\r\n\r\nBEST PERFORMING CAMPAIGNS (ROAS > 4x with spend > $50):\r\n${campaignPerformance.filter(c => c.roas >= 4 && c.spend > 50).slice(0, 8).map(c => \r\n  `- ${c.name} (${c.customer}): ${c.roas.toFixed(2)}x ROAS on $${c.spend.toFixed(2)} spend, ${c.conversions.toFixed(0)} conversions`\r\n).join('\\n') || 'None identified with ROAS > 4x'}\r\n\r\nUNDERPERFORMING CAMPAIGNS (ROAS < 1x with spend > $100):\r\n${campaignPerformance.filter(c => c.roas < 1 && c.spend > 100).slice(0, 8).map(c => \r\n  `- ${c.name} (${c.customer}): ${c.roas.toFixed(2)}x ROAS on $${c.spend.toFixed(2)} spend - consider pausing or restructuring`\r\n).join('\\n') || 'No significantly underperforming campaigns identified'}\r\n\r\nKEY EFFICIENCY METRICS:\r\n- Average CPC: $${avgCPC.toFixed(2)}\r\n- Conversion Rate: ${conversionRate.toFixed(2)}%\r\n- Cost Per Conversion: $${costPerConversion.toFixed(2)}\r\n\r\nCLIENT/CUSTOMER PERFORMANCE (sorted by spend):\r\n${customerMetrics.length > 0 ? customerMetrics.slice(0, 15).map((c, i) => \r\n  `${i + 1}. ${c.name}: Spend $${c.spend.toFixed(2)}, Revenue $${c.revenue.toFixed(2)}, ROAS ${c.roas.toFixed(2)}x, Conversions ${c.conversions.toFixed(0)}, CTR ${c.ctr.toFixed(2)}%`\r\n).join('\\n') : 'No customer-level data available'}\r\n\r\nTOP PERFORMERS (ROAS > 3x):\r\n${customerMetrics.filter(c => c.roas >= 3).length > 0 \r\n  ? customerMetrics.filter(c => c.roas >= 3).slice(0, 5).map(c => \r\n    `- ${c.name}: ${c.roas.toFixed(2)}x ROAS, $${c.spend.toFixed(2)} spend`\r\n  ).join('\\n')\r\n  : 'No top performers identified'}\r\n\r\nCLIENTS NEEDING ATTENTION (ROAS < 1.5x with significant spend):\r\n${customerMetrics.filter(c => c.roas < 1.5 && c.spend > 100).length > 0 \r\n  ? customerMetrics.filter(c => c.roas < 1.5 && c.spend > 100).slice(0, 5).map(c => \r\n    `- ${c.name}: ${c.roas.toFixed(2)}x ROAS, $${c.spend.toFixed(2)} spend - needs optimization`\r\n  ).join('\\n')\r\n  : 'All clients performing adequately'}\r\n` : hasConnectedAccounts ? `\r\nThe user has connected their ad accounts but data is still syncing. Ask them to click \"Sync Data\" in Settings if they haven't already.\r\n` : `\r\n⚠️ NO CAMPAIGN DATA CONNECTED YET\r\n\r\nThe user needs to:\r\n1. Connect their ad platform accounts in Settings (Google Ads, Meta Ads, LinkedIn Ads)\r\n2. Click \"Sync Data\" button after connecting accounts\r\n3. Wait for data to populate\r\n\r\nGuide them to connect their accounts first.`}\r\n\r\nYou should:\r\n- Provide actionable insights about campaign performance\r\n- Suggest optimization strategies based on actual data\r\n- Explain metrics like ROAS, CTR, CPA, CPC, and conversions in plain language\r\n- Compare platforms when asked\r\n- Be concise but thorough\r\n- Use specific numbers from their actual data - always cite real figures\r\n- If they have data, proactively highlight interesting patterns or concerns\r\n- Recommend specific actions: which campaigns to scale, pause, or optimize\r\n- When discussing a specific client, reference their full performance data\r\n- For campaign questions, provide detailed analysis including spend, revenue, ROAS, and CTR\r\n- Identify patterns across clients and campaigns\r\n- Suggest budget reallocation based on performance data\r\n- Alert about any campaigns that need immediate attention (high spend, low ROAS)\r\n\r\n${customInstructions ? `\r\nUSER'S CUSTOM INSTRUCTIONS (follow these preferences):\r\n${customInstructions}\r\n` : ''}`;\r\n\r\n    console.log(`Chat request: UI model=\"${model}\" -> Gateway model=\"${gatewayModelId}\"`);\r\n\r\n    // Use AI SDK with Vercel AI Gateway\r\n    const result = await generateText({\r\n      model: gateway(gatewayModelId),\r\n      system: systemPrompt,\r\n      messages: messages.map((m: any) => ({\r\n        role: m.role as 'user' | 'assistant',\r\n        content: m.content,\r\n      })),\r\n    });\r\n\r\n    return NextResponse.json({ message: result.text });\r\n  } catch (error: any) {\r\n    console.error('Chat API Error:', error);\r\n    console.error('Error details:', JSON.stringify({\r\n      name: error.name,\r\n      message: error.message,\r\n      cause: error.cause,\r\n      stack: error.stack?.split('\\n').slice(0, 5),\r\n    }, null, 2));\r\n    \r\n    // Provide more helpful error message\r\n    let errorMessage = 'Failed to process chat message';\r\n    if (error.message?.includes('model')) {\r\n      errorMessage = `Model error: The selected model may not be available. Try a different model.`;\r\n    } else if (error.message?.includes('API key') || error.message?.includes('authentication')) {\r\n      errorMessage = 'API key error: Please check your AI_GATEWAY_API_KEY configuration.';\r\n    } else if (error.message?.includes('rate limit')) {\r\n      errorMessage = 'Rate limit exceeded. Please try again later.';\r\n    }\r\n    \r\n    return NextResponse.json(\r\n      { error: errorMessage, details: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}